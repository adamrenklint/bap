// Bap v0.2.1 (http://bapjs.org)
// License: MIT Â© 2015 Adam Renklint (http://adamrenklint.com)

!function t(e,n,r){function i(s,a){if(!n[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[s]={exports:{}};e[s][0].call(l.exports,function(t){var n=e[s][1][t];return i(n?n:t)},l,l.exports,t,e,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(t,e){(function(n){var r=t("./lib/Bap");e.exports=n.bap=new r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./lib/Bap":2}],2:[function(t,e){function n(t,e){var n=[null].concat(e),r=t.bind.apply(t,n);return new r}var r=t("./Model"),i=t("./Clock"),o=t("./LoadingState"),s=r.extend({type:"bap",children:{clock:i,loadingState:o},initialize:function(){r.prototype.initialize.apply(this,arguments),this.vent.bap=this,this.on("change:loadingState.loading",this._onChangeLoadingState)},_onChangeLoadingState:function(){this.vent.loading=this.loadingState.loading}}),a={Kit:t("./Kit"),Slot:t("./Slot"),Layer:t("./Layer"),Pattern:t("./Pattern"),Sequence:t("./Sequence"),Channel:t("./Channel"),Note:t("./Note"),Oscillator:t("./Oscillator"),Sample:t("./Sample")};Object.keys(a).forEach(function(t){var e=a[t];s.prototype[t]=e,s.prototype[t.toLowerCase()]=function(){return n(e,[].slice.call(arguments))}}),e.exports=s},{"./Channel":3,"./Clock":4,"./Kit":6,"./Layer":8,"./LoadingState":9,"./Model":10,"./Note":11,"./Oscillator":12,"./Pattern":14,"./Sample":17,"./Sequence":18,"./Slot":19}],3:[function(t,e){var n=t("./Model"),r=t("./Note"),i=t("./Collection"),o=t("./mixins/volumeParams"),s=t("dilla-expressions"),a=i.extend({model:r}),u=n.extend(o,{type:"channel",props:{transform:"function"},collections:{rawNotes:a,expandedNotes:a},initialize:function(){n.prototype.initialize.apply(this,arguments),this._cache={},this.listenTo(this.rawNotes,"add",this._onAddRawNote),this.listenTo(this.rawNotes,"remove",this._onRemoveRawNote),this.listenTo(this.rawNotes,"change:position",this._onChangeRawNote),this.listenTo(this.expandedNotes,"start",this._start),this.listenTo(this.expandedNotes,"stop",this._stop),this.listenTo(this.expandedNotes,"add",this._onAddExpandedNote),this.listenTo(this.expandedNotes,"remove",this._onRemoveExpandedNote),this.cacheMethodUntilEvent("notes","change:expandedNotes")},add:function(){var t=[].slice.call(arguments).map(function(t){return t instanceof r?t:r.fromRaw(t)});return this.rawNotes.add(t),this},notes:function(t,e,n){if(!t)return this.expandedNotes.models.slice();var r=this._cache,i=r[t];if(!e)return(i&&i["*"]||[]).slice();var o=i&&i[e];return n?(o&&o[n]||[]).slice():(o&&o["*"]||[]).slice()},transforms:function(t){if(!(t&&t instanceof r))throw new Error("Invalid argument: note is not an instance of bap.note");var e=this.collection&&this.collection.parent,n=[];return[t,this,e].forEach(function(t){t&&t.transform&&"function"==typeof t.transform&&n.push(t.transform)}),n.length?function(t){n.forEach(function(e){e(t)})}:!1},_onAddExpandedNote:function(t){var e=this._cache,n=t.bar,r=t.beat,i=t.tick;e[n]=e[n]||{},e[n]["*"]=e[n]["*"]||[],e[n]["*"].push(t),e[n][r]=e[n][r]||{},e[n][r]["*"]=e[n][r]["*"]||[],e[n][r]["*"].push(t),e[n][r][i]=e[n][r][i]||[],e[n][r][i].push(t)},_onRemoveExpandedNote:function(t){var e=this._cache,n=t.bar,r=t.beat,i=t.tick,o=e[n]["*"].indexOf(t);e[n]["*"].splice(o,1);var s=e[n][r]["*"].indexOf(t);e[n][r]["*"].splice(s,1);var a=e[n][r][i].indexOf(t);e[n][r][i].splice(a,1)},_onAddRawNote:function(t){var e=this.transforms(t);if(t.hasPlainPosition()&&!e)return t.original=t,this.expandedNotes.add(t);var n=this.collection&&this.collection.parent,r={barsPerLoop:n&&n.bars||1,beatsPerBar:n&&n.beatsPerBar||4};s([[t.position]],r).forEach(function(n){var r=t.with({position:n[0]});r.original=t,e&&e(r),this.expandedNotes.add(r)}.bind(this))},_onRemoveRawNote:function(t){this.expandedNotes.models.slice().forEach(function(e){t===e.original&&(this.expandedNotes.remove(e),e.original=null)}.bind(this))},_onChangeRawNote:function(t){this._onRemoveRawNote(t),this._onAddRawNote(t)},_start:function(t,e){this.mute||this.trigger("start",t,e,this)},_stop:function(t,e){this.trigger("stop",t,e,this)}});e.exports=u},{"./Collection":5,"./Model":10,"./Note":11,"./mixins/volumeParams":25,"dilla-expressions":166}],4:[function(t,e){(function(n){var r=t("./PositionModel"),i=t("dilla"),o=t("./types/instanceOfType"),s=(t("lodash.debounce"),t("lodash.memoize")),a=r.extend({type:"clock",props:{playing:["boolean",!0,!1],sequence:"sequenceInstance",tempo:["number",!0,0],step:"function",_lastQueuedPosition:["string",!0,"0.0.00"],_stopByFold:"boolean"},dataTypes:{sequenceInstance:o("sequenceInstance",["sequence","pattern"])},initialize:function(){r.prototype.initialize.call(this),this.on("change:playing",this._onChangePlaying),this.on("change:sequence",this._onChangeSequence),this.on("change:position",this._onChangePosition),this.on("change:tempo",this._onChangeTempo),this.on("change:bar",this._scheduleSteps),this.on("change:beat",this._scheduleSteps),this.engine=new i(this.context),this.listenTo(this.engine,"tick",this._onEngineTick.bind(this)),this.listenTo(this.engine,"step",this._onEngineStep.bind(this)),this.engine.off=this.engine.removeAllListeners.bind(this.engine),this.listenTo(this.vent,"clock:start",this.start),this.listenTo(this.vent,"clock:pause",this.pause),this.listenTo(this.vent,"clock:stop",this.stop),this.listenTo(this.vent,"clock:tempo",this._applySequenceTempo)},_canStartPlaying:function(){return"loading"!==n.document.readyState&&!this.vent.loading},start:function(t){return this._canStartPlaying()?(t&&(this.sequence=t),this._stopByFold&&(this.position="1.1.01",this._stopByFold=!1),setTimeout(this.engine.start.bind(this.engine),1),this.playing=!0,void(!t&&this.sequence&&"0.0.00"!==this.position&&(this._lastQueuedPosition=this.position,this.engine.setPosition(this.position),this._updateTempo(this.position)))):setTimeout(function(){this.start(t)}.bind(this),10)},pause:function(t){t&&t!==this.sequence||(this.engine.pause(),this.playing=!1,this.tempo=0,this._lastQueuedPosition="0.0.00")},stop:function(t){t&&t!==this.sequence||(this.engine.stop(),this.playing=!1,this.position="1.1.01",this.tempo=0,this._lastQueuedPosition="0.0.00")},_scheduleSteps:function(){var t=this._lookaheadSteps();this.engine.set("lookahead",t.map(function(t){return[t]}))},_lookaheadSteps:function(){var t=this.bar||1,e=this.beat||1,n=this.sequence&&this.sequence.beatsPerBar||4,r=this.sequence&&this.sequence.bars||1;return a.possibleSteps(t,e,r,n)},_onChangePlaying:function(){var t=this.playing?"start":"pause";this[t](),this.sequence&&(this.sequence.playing=this.playing)},_onChangeSequence:function(){var t=this._previousAttributes.sequence;t&&this.stopListening(t),this.listenTo(this.sequence,"change:bars",this._onChangeSequence),this.listenTo(this.sequence,"change:beatsPerBar",this._onChangeSequence),this.engine.setBeatsPerBar(this.sequence.beatsPerBar),this.engine.setLoopLength(this.sequence.bars),this.tempo=this.sequence.tempo,this._scheduleSteps()},_onChangePosition:function(){"0.0.00"!==this.position&&this.position!==this.engine._position&&this.engine.setPosition(this.position)},_onChangeTempo:function(){this.engine.setTempo(this.tempo)},_onEngineTick:function(t){this.playing&&"0.0.00"!==t.position&&(this._stopByFold?(this.pause(),this.tick=96):(this.position=t.position,this.tempo=this.engine.tempo()))},_onEngineStep:function(t){this.playing&&("lookahead"!==t.id||this._foldingOverLoop(t.position)||(this._updateTempo(t.position),this._queueNotesForStep(t.position,t.time),this._lastQueuedPosition=t.position))},_updateTempo:function(t){if(this.sequence)if(t&&this.sequence.tempoAt){var e=a.fragments(t),n=a.ticksForTempoChange(this.tempo),r=e[2]>=96-n&&e[1]===this.sequence.beatsPerBar,i=r?e[0]+1:e[0];i>this.sequence.bars&&this.sequence.loop&&(i=1),this.tempo=this.sequence.tempoAt(i)}else this.tempo=this.sequence.tempo;else this.tempo=120},_foldingOverLoop:function(t){var e=a.paddedPosition(this._lastQueuedPosition),n=a.paddedPosition(t);return this._stopByFold=!this.sequence.loop&&e>n,this._stopByFold},_queueNotesForStep:function(t,e){if(this.sequence){var n=a.fragments(t),r=this.sequence.notes(n[0],n[1],n[2]);r=Array.isArray(r)?r:r[n[0]];var i="function"==typeof this.step?this.step:null;r.forEach(function(t){(!i||i&&i(t,e)!==!1)&&t.start(e)})}},_applySequenceTempo:function(t){t.tempo=this.engine.tempo()}});a.possibleSteps=s(function(t,e,n,r){function i(){for(var n=0;++n<97;)o.push([t,e,10>n?"0"+n:n].join("."))}var o=[];return i(),++e>r&&(e=1,++t>n&&(t=1)),i(),o},function(){return[].slice.call(arguments).join("//")}),a.ticksForTempoChange=s(function(t){var e=t/100,n=e>2?e-1:1,r=Math.ceil(e*n*4);return 2>r?2:r}),e.exports=a}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./PositionModel":16,"./types/instanceOfType":27,dilla:167,"lodash.debounce":174,"lodash.memoize":176}],5:[function(t,e){var n=(t("./utils/context"),t("ampersand-collection"));e.exports=n.extend({nextId:function(){for(var t,e=0;!t;)this.get(++e)||(t=e);return t}})},{"./utils/context":30,"ampersand-collection":34}],6:[function(t,e){var n=t("./Model"),r=t("./Slot"),i=t("./Collection"),o=t("./mixins/overloadedAccessor"),s=t("./mixins/triggerParams"),a=t("./mixins/volumeParams"),u=n.extend(s,a,{type:"kit",collections:{slots:i.extend({model:r})}},o("slot",r));e.exports=u},{"./Collection":5,"./Model":10,"./Slot":19,"./mixins/overloadedAccessor":21,"./mixins/triggerParams":24,"./mixins/volumeParams":25}],7:[function(t,e){var n=t("./Model"),r=t("./Kit"),i=t("./types/instanceOf"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),s={};o.forEach(function(t){s[t]="kit"});var a=n.extend({type:"kitsConnection",props:s,dataTypes:{kit:i("kit",r)},validIds:o,start:function(t,e,n){this._runEvent("start",t,e,n)},stop:function(t,e,n){this._runEvent("stop",t,e,n)},_runEvent:function(t,e,n,r){var i=n.key.slice(0,1),o=parseInt(n.key.slice(1),10),s=this[i];s&&!s.mute?s.slot(o)[t](e,n,r):console.warn("No kit found for "+n.key,n)}});e.exports=a},{"./Kit":6,"./Model":10,"./types/instanceOf":26}],8:[function(t,e){var n=t("./Model"),r=t("./mixins/triggerParams"),i=t("./mixins/volumeParams"),o=t("./Params"),s=n.extend(r,i,{type:"layer",props:{sources:["object",!0,function(){return{}}]},start:function(t,e,n){if(!this.mute){"number"!=typeof t&&(n=e,e=t,t=this.context.currentTime),e=e||{};var r=this._params(e,n),i=this._source(r);if(i){var o=i.gain=this._createGain(r,i);o=this._configureAttack(t,r,o),o=this._configurePan(r,o),i.connect(o),this._startSource(t,r,i);var s=e.cid||"null";if(this.sources[s]=this.sources[s]||[],this.sources[s].push(i),r.length){var a=t+r.length;this.stop(a,e,n),i.onended=function(){var t=this.sources[s].indexOf(i);this.sources[s].splice(t,1),i.disconnect(),i=i.onended=null}.bind(this)}}}},stop:function(t,e,n){"number"!=typeof t&&(n=e,e=t,t=this.context.currentTime),e=e||{};var r=this._params(e,n),i=e.cid||"null",o=this.sources[i]||[];"null"===i&&(o=[],Object.keys(this.sources).forEach(function(t){o=o.concat(this.sources[t])}.bind(this))),o.forEach(function(e){e.gain&&this._configureRelease(t,r,e.gain),this._stopSource(t,r,e),e.stop(t+r.release)}.bind(this))},_params:function(t,e){var n=this.collection&&this.collection.parent||{},r=n&&n.collection&&n.collection.parent||{},i=[t,e,this,n,r];return o.fromSources.apply(null,i)},_createGain:function(){return this.context.createGain()},_startSource:function(t,e,n){n.start(t)},_stopSource:function(t,e,n){n.stop(t)},_source:function(){},_output:function(){return this.context.destination},_configurePan:function(t,e){if(0!==t.pan){var n=this.context.createPanner(),r=t.pan/100,i=1-Math.abs(r);return n.setPosition(r,0,i),n.connect(e),n}return e},_configureAttack:function(t,e,n){var r=(e.volume||100)/100;return n.connect(this._output()),n.gain.setValueAtTime(0,t),n.gain.linearRampToValueAtTime(r,t+e.attack),n},_configureRelease:function(t,e,n){var r=(e.volume||100)/100;return n.gain.setValueAtTime(r,t),n.gain.linearRampToValueAtTime(0,t+e.release),n}});e.exports=s},{"./Model":10,"./Params":13,"./mixins/triggerParams":24,"./mixins/volumeParams":25}],9:[function(t,e){var n=t("./Model"),r=n.extend({type:"loadingState",props:{sources:["array",!0,function(){return[]}]},derived:{loading:{deps:["sources"],fn:function(){return!!this.sources.length}}},initialize:function(){n.prototype.initialize.apply(this,arguments),this.listenTo(this.vent,"loadingState:add",this._addSource),this.listenTo(this.vent,"loadingState:remove",this._removeSource),this.trigger("change:sources")},_addSource:function(t){this.sources.indexOf(t)<0&&(this.sources.push(t),this.trigger("change:sources"))},_removeSource:function(t){var e=this.sources.indexOf(t);e>-1&&(this.sources.splice(e,1),this.trigger("change:sources"))}});e.exports=r},{"./Model":10}],10:[function(t,e){function n(){return[].slice.call(arguments).join("//")}var r=t("./utils/context"),i=t("./utils/vent"),o=t("ampersand-state"),s=t("./utils/uniqueId"),a=t("lodash.merge"),u=t("lodash.memoize"),c=o.extend({type:"model",props:{id:["number"]},extraProperties:"reject",initialize:function(t,e){this.context=r.get(),this.vent=i,this.cid=s(this.type),o.prototype.initialize.apply(this,arguments),t&&this.set(t,a({silent:!0,initial:!0},e))},with:function(t){return t=a({},this.toJSON(),t),new this.constructor(t)},cacheMethodUntilEvent:function(t,e){var r=this[t].bind(this),i=function(){return this[t]=u(r,n),i}.bind(this);return this.on(e,i),i()},destroy:function(){this.off(),this.stopListening()},_initCollections:function(){o.prototype._initCollections.call(this);for(var t in this._collections)this.listenTo(this[t],"all",this._getCollectionEventBubblingHandler(t))},_getCollectionEventBubblingHandler:function(t){return function(e,n,r){var i=["change","add","remove"];if(~i.indexOf(e))this.trigger("change:"+t,n,r),this.trigger(e,this);else for(var o;i.length;)if(o=i.shift(),~e.indexOf(o+":")){for(var s=e.split(":"),a=s[0],u=[t].concat(s[1].split("."));u.length;)this.trigger(a+":"+u.join("."),n,r),u.pop();this.trigger(a,n,r)}}.bind(this)}});e.exports=c},{"./utils/context":30,"./utils/uniqueId":32,"./utils/vent":33,"ampersand-state":69,"lodash.memoize":176,"lodash.merge":177}],11:[function(t,e){var n=t("./PositionModel"),r=["position","key","duration","volume","pitch","pan"],i=t("./types/numberInRange"),o=t("./types/regexp"),s=t("./mixins/triggerParams"),a=t("./mixins/volumeParams"),u=t("./mixins/oscillatorParams"),c=t("./mixins/sampleParams"),l=n.extend(s,a,u,c,{type:"note",props:{key:["key",!1],ghosts:["array",!0,function(){return[]}],transform:"function"},dataTypes:{key:o("key",/^(A|B|C|D|E|F|G|H|I|J|K|L|M|N|O|P|Q|R|S|T|U|V|W|X|Y|Z)(\d+)$/),positiveNumber:i("positiveNumber",1,1/0)},start:function(t){this.mute||this.trigger("start",t,this)},stop:function(t){this.trigger("stop",t,this)},hasPlainPosition:function(){return l.isPlainPosition(this.position)}}),h=/^\d+\.\d+\.\d+$/;l.isPlainPosition=function(t){return h.test(t)},l.fromRaw=function(t){var e={},n=t[t.length-1];return"object"==typeof n&&null!==n&&(e=t.pop()),t.forEach(function(t,n){var i=r[n];i&&t&&(e[i]=t)}),new l(e)},e.exports=l},{"./PositionModel":16,"./mixins/oscillatorParams":20,"./mixins/sampleParams":22,"./mixins/triggerParams":24,"./mixins/volumeParams":25,"./types/numberInRange":28,"./types/regexp":29}],12:[function(t,e){var n=t("./Layer"),r=t("audio-notes"),i=t("./mixins/oscillatorParams"),o=n.extend(i,{type:"oscillator",_source:function(t){var e=this.context.createOscillator(),n=t.frequency;t.note&&(n=r[t.note]||n),e.frequency.value=n;var i=12*t.pitch;return e.detune.value=i,e.type=t.shape,e}});e.exports=o},{"./Layer":8,"./mixins/oscillatorParams":20,"audio-notes":165}],13:[function(t,e){var n=t("./Model"),r=t("./mixins/triggerParams"),i=t("./mixins/volumeParams"),o=t("./mixins/oscillatorParams"),s=t("./mixins/sampleParams"),a=t("./types/numberInRange"),u=t("lodash.memoize"),c=n.extend(r,i,o,s,{type:"params",props:{tempo:["positiveNumber",!0,120]},dataTypes:{positiveNumber:a("positiveNumber",1,1/0)},initialize:function(){n.prototype.initialize.apply(this,arguments),this.vent.trigger("clock:tempo",this),this.length=this._calculateLength()},_calculateLength:function(){var t=this.length||0,e=this.duration&&this._lengthFromDuration(this.duration)||0;return e&&t>e||!t?(this.hasLengthFromDuration=!0,e):t},_lengthFromDuration:function(t){var e=60/this.tempo,n=e/96;return t*n}});c.mergeSources=u(function(t){var e={},n=["volume"],r=["pitch","pan"],i=Object.keys(c.prototype._definition);return i.forEach(function(i){"id"!==i&&(t.forEach(function(t){if(t){var o=t[i];if(~n.indexOf(i)){if(!o||0>o)return;var s=o/100;e[i]=e[i]?e[i]*s:o}else~r.indexOf(i)?(o=o||0,e[i]=(e[i]||0)+o):e[i]=o||e[i]}}),"pan"===i&&e[i]<-100?e[i]=-100:"pan"===i&&e[i]>100?e[i]=100:"undefined"==typeof e[i]&&delete e[i])}),e},function(t){var e=Object.keys(c.prototype._definition);return t.map(function(t){var n={};return e.forEach(function(e){n[e]=t&&t[e]}),JSON.stringify(n)}).join("//")}),c.fromSources=function(){var t=[].slice.call(arguments).reverse(),e=c.mergeSources(t);return new c(e)},e.exports=c},{"./Model":10,"./mixins/oscillatorParams":20,"./mixins/sampleParams":22,"./mixins/triggerParams":24,"./mixins/volumeParams":25,"./types/numberInRange":28,"lodash.memoize":176}],14:[function(t,e){var n=t("./PlayableModel"),r=t("./Channel"),i=t("./Collection"),o=t("./mixins/overloadedAccessor"),s=t("./KitsConnectionModel"),a=t("./types/numberInRange"),u=t("./Sequence"),c=t("./utils/sequenceActions"),l=n.extend({type:"pattern",props:{bars:["positiveNumber",!0,1],beatsPerBar:["positiveNumber",!0,4],tempo:["positiveNumber",!0,120],loop:["boolean",!0,!0]},dataTypes:{positiveNumber:a("positiveNumber",1,1/0)},collections:{channels:i.extend({model:r})},children:{kits:s},initialize:function(){n.prototype.initialize.apply(this,arguments),this.listenTo(this.channels,"start",this.kits.start.bind(this.kits)),this.listenTo(this.channels,"stop",this.kits.stop.bind(this.kits)),this.cacheMethodUntilEvent("notes","change:channels")},notes:function(t,e,n){var r=[];return this.channels.forEach(function(i){r.push.apply(r,i.notes(t,e,n))}),r},kit:function(t,e){if(~this.kits.validIds.indexOf(t))return e?(this.kits[t]=e,this):this.kits[t];throw new Error("Invalid argument: kit id must be single letter from A to Z")},then:function(){var t=c.then(this,arguments);return new u({sequences:t})},after:function(){var t=c.after(this,arguments);return new u({sequences:t})},and:function(){var t=c.and(this,arguments);return new u({sequences:t})}},o("channel",r));e.exports=l},{"./Channel":3,"./Collection":5,"./KitsConnectionModel":7,"./PlayableModel":15,"./Sequence":18,"./mixins/overloadedAccessor":21,"./types/numberInRange":28,"./utils/sequenceActions":31}],15:[function(t,e){var n=t("./Model"),r=n.extend({type:"playable-model",props:{playing:["boolean",!0,!1]},initialize:function(){n.prototype.initialize.apply(this,arguments),this.on("change:playing",this._onChangePlaying.bind(this))},start:function(){return this.playing=!0,this.vent.trigger("clock:start",this),this},pause:function(){return this.playing=!1,this.vent.trigger("clock:pause",this),this},stop:function(){return this.playing=!1,this.vent.trigger("clock:stop",this),this},detachGhosts:function(){this.notes(!0).forEach(function(t){t.detachGhosts()})},notes:function(){return[]},_onChangePlaying:function(){var t=this.playing?"start":"pause";this[t]()}});e.exports=r},{"./Model":10}],16:[function(t,e){var n=t("./Model"),r=t("./types/numberInRange"),i=t("./types/regexp"),o=t("lodash.padleft"),s=t("lodash.memoize"),a=n.extend({type:"position-model",props:{position:["position",!0,"0.0.00"],bar:["positiveNumber",!1],beat:["positiveNumber",!1],tick:["tick",!1]},dataTypes:{position:i("position",/^(.+)\.(.+)\.(.+)$/),positiveNumber:r("positiveNumber",1,1/0),tick:r("tick",1,96)},initialize:function(){n.prototype.initialize.apply(this,arguments),this.on("change:position",this._updatePositionToFragments),this.on("change:bar",this._updatePositionFromFragments),this.on("change:beat",this._updatePositionFromFragments),this.on("change:tick",this._updatePositionFromFragments),this._updatePositionToFragments(),this._updatePositionFromFragments()},paddedPosition:function(){return a.paddedPosition(this.position)},fragments:function(){return a.fragments(this.position)},_updatePositionToFragments:function(){var t=this.position.split("."),e={};["bar","beat","tick"].forEach(function(n,r){var i=/^\d+$/.test(t[r])&&parseInt(t[r],10),o=isNaN(i)||1>i?void 0:i,s=this[n];s!==o&&(this.set(n,o,{silent:!0}),e[n]=!0)}.bind(this)),Object.keys(e).forEach(function(t){this.trigger("change:"+t)}.bind(this))},_updatePositionFromFragments:function(){var t=this.fragments(),e=this.bar||t[0],n=this.beat||t[1],r=this.tick||t[2];r=10>r&&"00"!==r?"0"+r:r,this.position=[e,n,r].join(".")}});a.paddedPosition=s(function(t){var e=5,n=a.fragments(t);return[o(n[0],e,"0"),o(n[1],e,"0"),o(n[2],e,"0")].join(".")}),a.fragments=s(function(t){return t.split(".").map(function(t){var e=parseInt(t,10);return/^\d+$/.test(t)&&!isNaN(e)?e:t})}),e.exports=a},{"./Model":10,"./types/numberInRange":28,"./types/regexp":29,"lodash.memoize":176,"lodash.padleft":194}],17:[function(t,e){var n=t("./Layer"),r=(t("./Kit"),t("./mixins/sampleParams")),i=t("lodash.memoize"),o=t("./utils/uniqueId"),s=t("audio-buffer-utils"),a={},u={},c=n.extend({type:"sample",props:{loaded:["boolean",!0,!1],sliceExpression:"string",buffer:"any"},constructor:function(t,e,r){"string"==typeof t?(e=e||{},e.src=t):(r=e,e=t),n.call(this,e,r)},initialize:function(t,e){n.prototype.initialize.call(this,t,e),this.on("change:src",this._loadSample),this.on("change:loaded",this._configureSlice),this.on("change:sliceExpression",this._configureSlice),this.src&&this._loadSample(),this._configureSlice()},slice:function(t){for(var e=new this.vent.bap.kit,n=0;t>n;n++)e.slot(n+1).layer(this.with({sliceExpression:""+(n+1)+"/"+t}));return e},_params:function(){var t=n.prototype._params.apply(this,arguments);t.length=t.length||this.buffer&&this.buffer.duration-t.offset||0,t.reverse&&(t.offset=this.buffer.duration-(t.offset+t.length));var e=t.playbackRate=this._getPlaybackRate(t);if(!t.hasLengthFromDuration){var r=t.length/e,i=t.duration&&t._lengthFromDuration(t.duration);t.length=i&&r>i?i:r}return t},_startSource:function(t,e,n){n.start(t,e.offset||0)},_source:function(t){if(!this.src)throw new Error("Cannot start sample without source url");if(!this.buffer)throw new Error("Cannot start sample without loaded buffer");var e=this.context.createBufferSource();return e.buffer=c.makeBuffer(t.toJSON(),this.buffer,this.context),e.playbackRate.value=t.playbackRate,t.loop>0&&(e.loop=!0,e.loopStart=t.offset,e.loopEnd=t.offset+t.loop),e},_getPlaybackRate:function(t){if(t.pitch<0){var e=-t.pitch/100,n=Math.floor(e),r=e-n,i=Math.pow(.5,n);return i*(1-.5*r)}return t.pitch/100+1},_loadSample:function(t){var e=a[this.src];if(e)this.buffer=e,u[this.src]--,this.loaded=!0,u[this.src]||this.vent.trigger("loadingState:remove",this.src);else{if(this.loaded=!1,u[this.src])return t!==!1&&u[this.src]++,setTimeout(this._loadSample.bind(this,!1),10);this.vent.trigger("loadingState:add",this.src),u[this.src]=1;var n=new XMLHttpRequest;n.open("GET",this.src,!0),n.responseType="arraybuffer",n.onload=function(){this.context.decodeAudioData(n.response,function(t){t.uid=o("buffer"),this.buffer=a[this.src]=t,u[this.src]--,this.loaded=!0,u[this.src]||this.vent.trigger("loadingState:remove",this.src)}.bind(this))}.bind(this),n.send()}},_configureSlice:function(){if(this.buffer&&this.loaded&&this.sliceExpression){var t=this.buffer.duration,e=this.sliceExpression.split("/"),n=parseInt(e[0],10)-1,r=parseInt(e[1],10),i=t/r,o=n*i;this.length=i,this.offset=o}}},r);c.makeBuffer=i(function(t,e,n){if(!t.channel||e.numberOfChannels<2){if(t.reverse){e.context=n;var r=s.clone(e);return s.reverse(r),r}return e}for(var i=n.createBuffer(1,e.length,e.sampleRate),o="left"===t.channel?0:1,a="left"===t.channel?1:0,u=e.getChannelData(o),c=e.getChannelData(a),l=i.getChannelData(0),h="merge"===t.channel,f="diff"===t.channel,p=0;p<u.length;p++)l[p]=h?u[p]+c[p]:f?u[p]-c[p]:u[p];return t.reverse&&s.reverse(i),i},function(t,e){return JSON.stringify(t)+e.uid}),e.exports=c},{"./Kit":6,"./Layer":8,"./mixins/sampleParams":22,"./utils/uniqueId":32,"audio-buffer-utils":162,"lodash.memoize":176}],18:[function(t,e){function n(t){return t.map(function(t){return t.map(function(t){return t.cid}).join("+")}).join(">")}function r(t){return t[0]&&t[0][0]}function i(t){var e=0;return t.forEach(function(t){t.bars>e&&(e=t.bars)}),e}function o(t,e){t.forEach(function(t){Array.isArray(t)?o(t,e):e(t)})}var s=t("./PlayableModel"),a=(t("./PositionModel"),t("./utils/sequenceActions")),u=s.extend({type:"sequence",props:{loop:["boolean",!0,!1],sequences:["sequence-grid",!0,function(){return[]}]},dataTypes:{"sequence-grid":{set:function(t){return{val:t,type:Array.isArray(t)&&Array.isArray(t[0])||!t[0]?"sequence-grid":typeof t}},compare:function(t,e){var r=n(t)===n(e);return r||(o(t,function(t){this.stopListening(t)}.bind(this)),o(e,function(t){this.listenTo(t,"change:channels change:sequences",this._forwardChannelChange)}.bind(this))),r}}},derived:{tempo:{deps:["sequences"],fn:function(){var t=r(this.sequences);return t&&t.tempo||120}},bars:{deps:["sequences"],fn:function(){var t=0;return this.sequences.length&&this.sequences.forEach(function(e){t+=i(e)}),t}},beatsPerBar:{deps:["sequences"],fn:function(){var t=r(this.sequences);return t&&t.beatsPerBar||4}}},constructor:function(){for(var t=Array.prototype.slice.call(arguments),e=["sequence","pattern"],n=[],r=!0;r&&t.length;)t[0]&&~e.indexOf(t[0].type)?n.push([t.shift()]):t[0]&&Array.isArray(t[0])?n.push(t.shift()):r=!1;t[0]=t[0]||{},n.length&&(t[0].sequences=n),s.apply(this,t)},initialize:function(){s.prototype.initialize.apply(this,arguments),this.cacheMethodUntilEvent("notes","change:sequences"),this.cacheMethodUntilEvent("patterns","change:sequences"),this.cacheMethodUntilEvent("tempoAt","change:sequences")},notes:function(t,e,n){var r={};if(1>t||t>this.bars)throw new Error("Invalid argument: bar is not within sequence length");r[t]=[];{var i=this.patterns(t);this.cid}return Object.keys(i).forEach(function(o){var s=i[o],a=t-parseInt(o,10);s.forEach(function(i){r[t]=r[t].concat(i.notes(a,e,n))})}),r},patterns:function(t,e){if("number"!=typeof t)throw new Error("Invalid argument: bar is not a number");if(1>t||t>this.bars)throw new Error("Invalid argument: bar is not within sequence length");var n={},r=this.sequences.slice(),o=0;e=e||0;for(var s,a,u,c;r.length;)s=r.shift(),a=i(s),u=o+1,c=o+a,t>=u&&c>=t?r=[]:o+=a;this.cid;return s.forEach(function(r){var i=o+e;if("sequence"===r.type){var s=r.patterns(t-o,i);Object.keys(s).forEach(function(t){var e=s[t];n[t]=(n[t]||[]).concat(e)})}else n[i]=n[i]||[],n[i].push(r)}),n},tempoAt:function(t){var e=this.tempoChanges(),n=e.filter(function(e){return e[0]<=t});return n.length?n[n.length-1][1]:120},tempoChanges:function(){var t=[],e=1,n=null;return this.sequences.forEach(function(r){r=r[0],r.tempo!==n&&(t.push([e,r.tempo,r.beatsPerBar]),n=r.tempo),e+=r.bars}),t},then:function(){var t=a.then(this,arguments);return new this.constructor({sequences:t})},after:function(){var t=a.after(this,arguments);return new this.constructor({sequences:t})},and:function(){var t=a.and(this,arguments);return new this.constructor({sequences:t})},_forwardChannelChange:function(){this.trigger("change:sequences")}});e.exports=u},{"./PlayableModel":15,"./PositionModel":16,"./utils/sequenceActions":31}],19:[function(t,e){var n=t("./Model"),r=t("./Layer"),i=t("./Collection"),o=t("./mixins/overloadedAccessor"),s=t("./mixins/triggerParams"),a=t("./mixins/volumeParams"),u=t("./mixins/sampleShortcut"),c=n.extend(s,a,{type:"slot",collections:{layers:i.extend({model:r})},initialize:function(){n.prototype.initialize.apply(this,arguments),this._initSampleShortcut()},start:function(t,e,n){this.mute||this.layers.each(function(r){r.start(t,e,n)}.bind(this))},stop:function(t,e,n){this.layers.each(function(r){r.stop(t,e,n)}.bind(this))}},o("layer",r),u);e.exports=c},{"./Collection":5,"./Layer":8,"./Model":10,"./mixins/overloadedAccessor":21,"./mixins/sampleShortcut":23,"./mixins/triggerParams":24,"./mixins/volumeParams":25}],20:[function(t,e){var n=t("../types/numberInRange");e.exports={props:{frequency:["inclusivePositiveNumber",!0,0],note:"string",shape:{type:"string",default:"sine",values:["sine","square","sawtooth","triangle","custom"]}},dataTypes:{inclusivePositiveNumber:n("inclusivePositiveNumber",0,1/0)}}},{"../types/numberInRange":28}],21:[function(t,e){function n(t,e){var n={};return n[t]=function(n,r){var i=!1,o=this[t+"s"];return!r&&n instanceof e?(r=n,r.id=o.nextId(),i=!0):"number"!=typeof n||r?n&&r instanceof e?(o.remove(o.get(n)),r.id=n,i=!0):r=new e({id:o.nextId()}):r=o.get(n)||new e({id:n}),r=o.add(r),i?this:r},n}e.exports=n},{}],22:[function(t,e){var n=t("../types/numberInRange");e.exports={props:{src:"string",offset:["inclusivePositiveNumber",!0,0],loop:["inclusivePositiveNumber",!0,0],playbackRate:["inclusivePositiveNumber",!0,1],channel:{type:"any",values:[null,!1,void 0,"left","right","merge","diff"]},reverse:["boolean",!0,!1]},dataTypes:{inclusivePositiveNumber:n("inclusivePositiveNumber",0,1/0)}}},{"../types/numberInRange":28}],23:[function(t,e){var n=t("../Sample");e.exports={_sampleConstructor:n,_initSampleShortcut:function(){this._originalLayerFunction=this.layer,this.layer=this._overloadedLayerFn},_overloadedLayerFn:function(t,e){if("string"==typeof t){e=e||{},e.src=t;var n=new this._sampleConstructor(e);return this.layers.add(n),this}return this._originalLayerFunction.apply(this,arguments)}}},{"../Sample":17}],24:[function(t,e){var n=t("../types/numberInRange");e.exports={props:{duration:"positiveNumber",length:"inclusivePositiveNumber",attack:["inclusivePositiveNumber",!0,0],release:["inclusivePositiveNumber",!0,0],pitch:"number"},dataTypes:{positiveNumber:n("positiveNumber",1,1/0),inclusivePositiveNumber:n("inclusivePositiveNumber",0,1/0)}}},{"../types/numberInRange":28}],25:[function(t,e){var n=t("../types/numberInRange");e.exports={props:{volume:["inclusivePositiveNumber",!0,100],mute:["boolean",!0,!1],pan:["panRange",!0,0]},dataTypes:{inclusivePositiveNumber:n("inclusivePositiveNumber",0,1/0),panRange:n("panRange",-100,100)}}},{"../types/numberInRange":28}],26:[function(t,e){function n(t,e){return{set:function(n){return n instanceof e?{val:n,type:t}:{val:n,type:typeof n}},compare:function(t,e,n){var r=t===e;return r||(t&&this.stopListening(t),null!==e&&this.listenTo(e,"all",this._getEventBubblingHandler(n))),r}}}e.exports=n},{}],27:[function(t,e){function n(t,e){return{set:function(n){return~e.indexOf(n.type)?{val:n,type:t}:{val:n,type:typeof n}},compare:function(t,e,n){var r=t===e;return r||(t&&this.stopListening(t),null!==e&&this.listenTo(e,"all",this._getEventBubblingHandler(n))),r}}}e.exports=n},{}],28:[function(t,e){function n(t,e,n){return{set:function(r){return r>=e&&n>=r?{val:r,type:t}:{val:r,type:typeof r}}}}e.exports=n},{}],29:[function(t,e){function n(t,e){return{set:function(n){return e.test(n)?{val:n,type:t}:{val:n,type:typeof n}}}}e.exports=n},{}],30:[function(t,e){var n=t("audio-context");e.exports={set:function(t){n=t},get:function(){return n}}},{"audio-context":163}],31:[function(t,e){e.exports={then:function(t,e){return e=[].slice.call(e),[t].concat(e).map(function(t){return Array.isArray(t)||(t=[t]),t})},after:function(t,e){return e=[].slice.call(e),e.concat(t).map(function(t){return Array.isArray(t)||(t=[t]),t})},and:function(t,e){function n(t){~r.indexOf(t)||r.push(t)}e=[].slice.call(e);var r=[t];return e.forEach(function(t){Array.isArray(t)?t.forEach(n):n(t)}),[r]}}},{}],32:[function(t,e){function n(t){return r[t]=r[t]||0,
t+"-"+ ++r[t]}var r={};e.exports=n},{}],33:[function(t,e){var n=t("ampersand-state");e.exports=new(n.extend())},{"ampersand-state":69}],34:[function(t,e){function n(t,e){if(e||(e={}),e.model&&(this.model=e.model),e.comparator&&(this.comparator=e.comparator),e.parent&&(this.parent=e.parent),!this.mainIndex){var n=this.model&&this.model.prototype&&this.model.prototype.idAttribute;this.mainIndex=n||"id"}this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,a({silent:!0},e))}var r=t("ampersand-events"),i=t("ampersand-class-extend"),o=t("lodash.isarray"),s=t("lodash.bind"),a=t("lodash.assign"),u=[].slice;a(n.prototype,r,{initialize:function(){},isModel:function(t){return this.model&&t instanceof this.model},add:function(t,e){return this.set(t,a({merge:!1,add:!0,remove:!1},e))},parse:function(t){return t},serialize:function(){return this.map(function(t){if(t.serialize)return t.serialize();var e={};return a(e,t),delete e.collection,e})},toJSON:function(){return this.serialize()},set:function(t,e){e=a({add:!0,remove:!0,merge:!0},e),e.parse&&(t=this.parse(t,e));var n=!o(t);t=n?t?[t]:[]:t.slice();var r,i,s,u,c,l,h,f=e.at,p=this.comparator&&null==f&&e.sort!==!1,d="string"==typeof this.comparator?this.comparator:null,g=[],v=[],m={},y=e.add,b=e.merge,_=e.remove,w=!p&&y&&_?[]:!1,x=this.model&&this.model.prototype||Object.prototype;for(l=0,h=t.length;h>l;l++){if(s=t[l]||{},r=this.isModel(s)?i=s:x.generateId?x.generateId(s):s[this.mainIndex],u=this.get(r))_&&(m[u.cid||u[this.mainIndex]]=!0),b&&(s=s===i?i.attributes:s,e.parse&&(s=u.parse(s,e)),u.set?(u.set(s,e),p&&!c&&u.hasChanged(d)&&(c=!0)):a(u,s)),t[l]=u;else if(y){if(i=t[l]=this._prepareModel(s,e),!i)continue;g.push(i),this._addReference(i,e)}i=u||i,i&&(w&&(i.isNew&&i.isNew()||!i[this.mainIndex]||!m[i.cid||i[this.mainIndex]])&&w.push(i),m[i[this.mainIndex]]=!0)}if(_){for(l=0,h=this.length;h>l;l++)i=this.models[l],m[i.cid||i[this.mainIndex]]||v.push(i);v.length&&this.remove(v,e)}if(g.length||w&&w.length)if(p&&(c=!0),null!=f)for(l=0,h=g.length;h>l;l++)this.models.splice(f+l,0,g[l]);else{var E=w||g;for(l=0,h=E.length;h>l;l++)this.models.push(E[l])}if(c&&this.sort({silent:!0}),!e.silent){for(l=0,h=g.length;h>l;l++)i=g[l],i.trigger?i.trigger("add",i,this,e):this.trigger("add",i,this,e);(c||w&&w.length)&&this.trigger("sort",this,e)}return n?t[0]:t},get:function(t,e){if(null!=t){var n=this._indexes[e||this.mainIndex];return n&&(n[t]||n[t[this.mainIndex]])||this._indexes.cid[t]||this._indexes.cid[t.cid]}},at:function(t){return this.models[t]},remove:function(t,e){var n,r,i,s,a=!o(t);for(t=a?[t]:u.call(t),e||(e={}),n=0,r=t.length;r>n;n++)i=t[n]=this.get(t[n]),i&&(this._deIndex(i),s=this.models.indexOf(i),this.models.splice(s,1),e.silent||(e.index=s,i.trigger?i.trigger("remove",i,this,e):this.trigger("remove",i,this,e)),this._removeReference(i,e));return a?t[0]:t},reset:function(t,e){e||(e={});for(var n=0,r=this.models.length;r>n;n++)this._removeReference(this.models[n],e);return e.previousModels=this.models,this._reset(),t=this.add(t,a({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},sort:function(t){var e=this;if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),this.models.sort("string"==typeof this.comparator?function(t,n){return t.get?(t=t.get(e.comparator),n=n.get(e.comparator)):(t=t[e.comparator],n=n[e.comparator]),t>n||void 0===t?1:n>t||void 0===n?-1:0}:1===this.comparator.length?function(t,n){return t=e.comparator(t),n=e.comparator(n),t>n||void 0===t?1:n>t||void 0===n?-1:0}:s(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},_reset:function(){var t=u.call(this.indexes||[]),e=0;t.push(this.mainIndex),t.push("cid");var n=t.length;for(this.models=[],this._indexes={};n>e;e++)this._indexes[t[e]]={}},_prepareModel:function(t,e){if(!this.model)return t;if(this.isModel(t))return t.collection||(t.collection=this),t;e=e?a({},e):{},e.collection=this;var n=new this.model(t,e);return n.validationError?(this.trigger("invalid",this,n.validationError,e),!1):n},_deIndex:function(t,e,n){var r;if(void 0!==e){if(void 0===this._indexes[e])throw new Error("Given attribute is not an index");return void delete this._indexes[e][n]}for(e in this._indexes)r=t.hasOwnProperty(e)?t[e]:t.get&&t.get(e),delete this._indexes[e][r]},_index:function(t,e){var n;if(void 0!==e){if(void 0===this._indexes[e])throw new Error("Given attribute is not an index");return n=t[e]||t.get&&t.get(e),void(n&&(this._indexes[e][n]=t))}for(e in this._indexes)n=t.hasOwnProperty(e)?t[e]:t.get&&t.get(e),null!=n&&(this._indexes[e][n]=t)},_addReference:function(t){this._index(t),t.collection||(t.collection=this),t.on&&t.on("all",this._onModelEvent,this)},_removeReference:function(t){this===t.collection&&delete t.collection,this._deIndex(t),t.off&&t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,r){var i=t.split(":")[0],o=t.split(":")[1];("add"!==i&&"remove"!==i||n===this)&&("destroy"===i&&this.remove(e,r),e&&"change"===i&&o&&this._indexes[o]&&(this._deIndex(e,o,e.previousAttributes()[o]),this._index(e,o)),this.trigger.apply(this,arguments))}}),Object.defineProperties(n.prototype,{length:{get:function(){return this.models.length}},isCollection:{value:!0}});var c=["indexOf","lastIndexOf","every","some","forEach","map","filter","reduce","reduceRight"];c.forEach(function(t){n.prototype[t]=function(){return this.models[t].apply(this.models,arguments)}}),n.prototype.each=n.prototype.forEach,n.extend=i,e.exports=n},{"ampersand-class-extend":35,"ampersand-events":36,"lodash.assign":52,"lodash.bind":62,"lodash.isarray":68}],35:[function(t,e){var n=t("lodash.assign"),r=function(t){var e,r=this,i=[].slice.call(arguments);e=t&&t.hasOwnProperty("constructor")?t.constructor:function(){return r.apply(this,arguments)},n(e,r);var o=function(){this.constructor=e};return o.prototype=r.prototype,e.prototype=new o,t&&(i.unshift(e.prototype),n.apply(null,i)),e.__super__=r.prototype,e};e.exports=r},{"lodash.assign":52}],36:[function(t,e){"undefined"!=typeof window&&(window.ampersand=window.ampersand||{},window.ampersand["ampersand-events"]=window.ampersand["ampersand-events"]||[],window.ampersand["ampersand-events"].push("1.1.1"));var n=t("lodash.once"),r=t("lodash.uniqueid"),i=t("lodash.keys"),o=t("lodash.isempty"),s=t("lodash.foreach"),a=(t("lodash.bind"),t("lodash.assign")),u=Array.prototype.slice,c=/\s+/,l={on:function(t,e,n){if(!h(this,"on",t,[e,n])||!e)return this;this._events||(this._events={});var r=this._events[t]||(this._events[t]=[]);return r.push({callback:e,context:n,ctx:n||this}),this},once:function(t,e,r){if(!h(this,"once",t,[e,r])||!e)return this;var i=this,o=n(function(){i.off(t,o),e.apply(this,arguments)});return o._callback=e,this.on(t,o,r)},off:function(t,e,n){var r,o,s,a,u,c,l,f;if(!this._events||!h(this,"off",t,[e,n]))return this;if(!t&&!e&&!n)return this._events=void 0,this;for(a=t?[t]:i(this._events),u=0,c=a.length;c>u;u++)if(t=a[u],s=this._events[t]){if(this._events[t]=r=[],e||n)for(l=0,f=s.length;f>l;l++)o=s[l],(e&&e!==o.callback&&e!==o.callback._callback||n&&n!==o.context)&&r.push(o);r.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=u.call(arguments,1);if(!h(this,"trigger",t,e))return this;var n=this._events[t],r=this._events.all;return n&&f(n,e),r&&f(r,arguments),this},stopListening:function(t,e,n){var r=this._listeningTo;if(!r)return this;var i=!e&&!n;n||"object"!=typeof e||(n=this),t&&((r={})[t._listenId]=t);for(var s in r)t=r[s],t.off(e,n,this),(i||o(t._events))&&delete this._listeningTo[s];return this},createEmitter:function(t){return a(t||{},l)}};l.bind=l.on,l.unbind=l.off;var h=function(t,e,n,r){if(!n)return!0;if("object"==typeof n){for(var i in n)t[e].apply(t,[i,n[i]].concat(r));return!1}if(c.test(n)){for(var o=n.split(c),s=0,a=o.length;a>s;s++)t[e].apply(t,[o[s]].concat(r));return!1}return!0},f=function(t,e){var n,r=-1,i=t.length,o=e[0],s=e[1],a=e[2];switch(e.length){case 0:for(;++r<i;)(n=t[r]).callback.call(n.ctx);return;case 1:for(;++r<i;)(n=t[r]).callback.call(n.ctx,o);return;case 2:for(;++r<i;)(n=t[r]).callback.call(n.ctx,o,s);return;case 3:for(;++r<i;)(n=t[r]).callback.call(n.ctx,o,s,a);return;default:for(;++r<i;)(n=t[r]).callback.apply(n.ctx,e);return}},p={listenTo:"on",listenToOnce:"once"};s(p,function(t,e){l[e]=function(e,n,i){var o=this._listeningTo||(this._listeningTo={}),s=e._listenId||(e._listenId=r("l"));return o[s]=e,i||"object"!=typeof n||(i=this),e[t](n,i,this),this}}),l.listenToAndRun=function(t,e,n){return l.listenTo.apply(this,arguments),n||"object"!=typeof e||(n=this),n.apply(this),this},e.exports=l},{"lodash.assign":52,"lodash.bind":62,"lodash.foreach":37,"lodash.isempty":41,"lodash.keys":45,"lodash.once":48,"lodash.uniqueid":50}],37:[function(t,e){function n(t,e){return function(n,r,i){return"function"==typeof r&&void 0===i&&s(n)?t(n,r):e(n,o(r,i,3))}}var r=t("lodash._arrayeach"),i=t("lodash._baseeach"),o=t("lodash._bindcallback"),s=t("lodash.isarray"),a=n(r,i);e.exports=a},{"lodash._arrayeach":38,"lodash._baseeach":39,"lodash._bindcallback":40,"lodash.isarray":68}],38:[function(t,e){function n(t,e){for(var n=-1,r=t.length;++n<r&&e(t[n],n,t)!==!1;);return t}e.exports=n},{}],39:[function(t,e){function n(t,e){return f(t,e,c)}function r(t){return function(e){return null==e?void 0:e[t]}}function i(t,e){return function(n,r){var i=n?p(n):0;if(!s(i))return t(n,r);for(var o=e?i:-1,u=a(n);(e?o--:++o<i)&&r(u[o],o,u)!==!1;);return n}}function o(t){return function(e,n,r){for(var i=a(e),o=r(e),s=o.length,u=t?s:-1;t?u--:++u<s;){var c=o[u];if(n(i[c],c,i)===!1)break}return e}}function s(t){return"number"==typeof t&&t>-1&&t%1==0&&l>=t}function a(t){return u(t)?t:Object(t)}function u(t){var e=typeof t;return"function"==e||!!t&&"object"==e}var c=t("lodash.keys"),l=Math.pow(2,53)-1,h=i(n),f=o(),p=r("length");e.exports=h},{"lodash.keys":45}],40:[function(t,e){function n(t,e,n){if("function"!=typeof t)return r;if(void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 3:return function(n,r,i){return t.call(e,n,r,i)};case 4:return function(n,r,i,o){return t.call(e,n,r,i,o)};case 5:return function(n,r,i,o,s){return t.call(e,n,r,i,o,s)}}return function(){return t.apply(e,arguments)}}function r(t){return t}e.exports=n},{}],41:[function(t,e){function n(t){return!!t&&"object"==typeof t}function r(t){return function(e){return null==e?void 0:e[t]}}function i(t){return null!=t&&o(p(t))}function o(t){return"number"==typeof t&&t>-1&&t%1==0&&f>=t}function s(t){return null==t?!0:i(t)&&(u(t)||l(t)||a(t)||n(t)&&c(t.splice))?!t.length:!h(t).length}var a=t("lodash.isarguments"),u=t("lodash.isarray"),c=t("lodash.isfunction"),l=t("lodash.isstring"),h=t("lodash.keys"),f=Math.pow(2,53)-1,p=r("length");e.exports=s},{"lodash.isarguments":42,"lodash.isarray":68,"lodash.isfunction":43,"lodash.isstring":44,"lodash.keys":45}],42:[function(t,e){function n(t){return!!t&&"object"==typeof t}function r(t){return function(e){return null==e?void 0:e[t]}}function i(t){return null!=t&&o(h(t))}function o(t){return"number"==typeof t&&t>-1&&t%1==0&&l>=t}function s(t){return n(t)&&i(t)&&c.call(t)==a}var a="[object Arguments]",u=Object.prototype,c=u.toString,l=Math.pow(2,53)-1,h=r("length");e.exports=s},{}],43:[function(t,e){(function(t){function n(t){return"function"==typeof t||!1}function r(t){return"string"==typeof t?t:null==t?"":t+""}function i(t){return!!t&&"object"==typeof t}function o(t){return null==t?!1:p.call(t)==a?d.test(f.call(t)):i(t)&&l.test(t)}function s(t){return t=r(t),t&&c.test(t)?t.replace(u,"\\$&"):t}var a="[object Function]",u=/[.*+?^${}()|[\]\/\\]/g,c=RegExp(u.source),l=/^\[object .+?Constructor\]$/,h=Object.prototype,f=Function.prototype.toString,p=h.toString,d=RegExp("^"+s(p).replace(/toString|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),g=o(g=t.Uint8Array)&&g,v=n(/x/)||g&&!n(g)?function(t){return p.call(t)==a}:n;e.exports=v}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],44:[function(t,e){function n(t){return!!t&&"object"==typeof t}function r(t){return"string"==typeof t||n(t)&&s.call(t)==i}var i="[object String]",o=Object.prototype,s=o.toString;e.exports=r},{}],45:[function(t,e){function n(t){return function(e){return null==e?void 0:e[t]}}function r(t){return null!=t&&o(y(t))}function i(t,e){return t=+t,e=null==e?v:e,t>-1&&t%1==0&&e>t}function o(t){return"number"==typeof t&&t>-1&&t%1==0&&v>=t}function s(t){for(var e=u(t),n=e.length,r=n&&t.length,s=r&&o(r)&&(l(t)||m.nonEnumArgs&&c(t)),a=-1,h=[];++a<n;){var f=e[a];(s&&i(f,r)||p.call(t,f))&&h.push(f)}return h}function a(t){var e=typeof t;return"function"==e||!!t&&"object"==e}function u(t){if(null==t)return[];a(t)||(t=Object(t));var e=t.length;e=e&&o(e)&&(l(t)||m.nonEnumArgs&&c(t))&&e||0;for(var n=t.constructor,r=-1,s="function"==typeof n&&n.prototype===t,u=Array(e),h=e>0;++r<e;)u[r]=r+"";for(var f in t)h&&i(f,e)||"constructor"==f&&(s||!p.call(t,f))||u.push(f);return u}var c=t("lodash.isarguments"),l=t("lodash.isarray"),h=t("lodash.isnative"),f=Object.prototype,p=f.hasOwnProperty,d=f.propertyIsEnumerable,g=h(g=Object.keys)&&g,v=Math.pow(2,53)-1,m={};!function(t){var e=function(){this.x=t},n=arguments,r=[];e.prototype={valueOf:t,y:t};for(var i in new e)r.push(i);try{m.nonEnumArgs=!d.call(n,1)}catch(t){m.nonEnumArgs=!0}}(1,0);var y=n("length"),b=g?function(t){var e=null!=t&&t.constructor;return"function"==typeof e&&e.prototype===t||"function"!=typeof t&&r(t)?s(t):a(t)?g(t):[]}:s;e.exports=b},{"lodash.isarguments":46,"lodash.isarray":68,"lodash.isnative":47}],46:[function(t,e,n){arguments[4][42][0].apply(n,arguments)},{dup:42}],47:[function(t,e){function n(t){return"string"==typeof t?t:null==t?"":t+""}function r(t){return!!t&&"object"==typeof t}function i(t){return null==t?!1:f.call(t)==s?p.test(h.call(t)):r(t)&&c.test(t)}function o(t){return t=n(t),t&&u.test(t)?t.replace(a,"\\$&"):t}var s="[object Function]",a=/[.*+?^${}()|[\]\/\\]/g,u=RegExp(a.source),c=/^\[object .+?Constructor\]$/,l=Object.prototype,h=Function.prototype.toString,f=l.toString,p=RegExp("^"+o(f).replace(/toString|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=i},{}],48:[function(t,e){function n(t){return r(2,t)}var r=t("lodash.before");e.exports=n},{"lodash.before":49}],49:[function(t,e){function n(t,e){var n;if("function"!=typeof e){if("function"!=typeof t)throw new TypeError(r);var i=t;t=e,e=i}return function(){return--t>0&&(n=e.apply(this,arguments)),1>=t&&(e=null),n}}var r="Expected a function";e.exports=n},{}],50:[function(t,e){function n(t){var e=++i;return r(t)+e}var r=t("lodash._basetostring"),i=0;e.exports=n},{"lodash._basetostring":51}],51:[function(t,e){function n(t){return"string"==typeof t?t:null==t?"":t+""}e.exports=n},{}],52:[function(t,e){function n(t,e,n){var r=c(e);f.apply(r,p(e));for(var i=-1,o=r.length;++i<o;){var s=r[i],a=t[s],u=n(a,e[s],s,t,e);(u===u?u===a:a!==a)&&(void 0!==a||s in t)||(t[s]=u)}return t}function r(t){return i(t)?t:Object(t)}function i(t){var e=typeof t;return"function"==e||!!t&&"object"==e}function o(t){return function(){return t}}var s=t("lodash._baseassign"),a=t("lodash._createassigner"),u=t("lodash.isnative"),c=t("lodash.keys"),l=Array.prototype,h=u(h=Object.getOwnPropertySymbols)&&h,f=l.push,p=h?function(t){return h(r(t))}:o([]),d=a(function(t,e,r){return r?n(t,e,r):s(t,e)});e.exports=d},{"lodash._baseassign":53,"lodash._createassigner":55,"lodash.isnative":59,"lodash.keys":60}],53:[function(t,e){function n(t){return r(t)?t:Object(t)}function r(t){var e=typeof t;return"function"==e||!!t&&"object"==e}function i(t){return function(){return t}}var o=t("lodash._basecopy"),s=t("lodash.isnative"),a=t("lodash.keys"),u=s(u=Object.getOwnPropertySymbols)&&u,c=function(t,e){return null==e?t:o(e,l(e),o(e,a(e),t))},l=u?function(t){return u(n(t))}:i([]);e.exports=c},{"lodash._basecopy":54,"lodash.isnative":59,"lodash.keys":60}],54:[function(t,e){function n(t,e,n){n||(n={});for(var r=-1,i=e.length;++r<i;){var o=e[r];n[o]=t[o]}return n}e.exports=n},{}],55:[function(t,e){function n(t){return o(function(e,n){var o=-1,s=null==e?0:n.length,a=s>2&&n[s-2],u=s>2&&n[2],c=s>1&&n[s-1];for("function"==typeof a?(a=r(a,c,5),s-=2):(a="function"==typeof c?c:null,s-=a?1:0),u&&i(n[0],n[1],u)&&(a=3>s?null:a,s=1);++o<s;){var l=n[o];l&&t(e,l,a)}return e})}var r=t("lodash._bindcallback"),i=t("lodash._isiterateecall"),o=t("lodash.restparam");e.exports=n},{"lodash._bindcallback":56,"lodash._isiterateecall":57,"lodash.restparam":58}],56:[function(t,e,n){arguments[4][40][0].apply(n,arguments)},{dup:40}],57:[function(t,e){function n(t){return function(e){return null==e?void 0:e[t]}}function r(t){return null!=t&&s(c(t))}function i(t,e){return t=+t,e=null==e?u:e,t>-1&&t%1==0&&e>t}function o(t,e,n){if(!a(n))return!1;var o=typeof e;if("number"==o?r(n)&&i(e,n.length):"string"==o&&e in n){var s=n[e];return t===t?t===s:s!==s}return!1}function s(t){return"number"==typeof t&&t>-1&&t%1==0&&u>=t}function a(t){var e=typeof t;return"function"==e||!!t&&"object"==e}var u=Math.pow(2,53)-1,c=n("length");e.exports=o},{}],58:[function(t,e){function n(t,e){if("function"!=typeof t)throw new TypeError(r);return e=i(void 0===e?t.length-1:+e||0,0),function(){for(var n=arguments,r=-1,o=i(n.length-e,0),s=Array(o);++r<o;)s[r]=n[e+r];switch(e){case 0:return t.call(this,s);case 1:return t.call(this,n[0],s);case 2:return t.call(this,n[0],n[1],s)}var a=Array(e+1);for(r=-1;++r<e;)a[r]=n[r];return a[e]=s,t.apply(this,a)}}var r="Expected a function",i=Math.max;e.exports=n},{}],59:[function(t,e,n){arguments[4][47][0].apply(n,arguments)},{dup:47}],60:[function(t,e,n){arguments[4][45][0].apply(n,arguments)},{dup:45,"lodash.isarguments":61,"lodash.isarray":68,"lodash.isnative":59}],61:[function(t,e,n){arguments[4][42][0].apply(n,arguments)},{dup:42}],62:[function(t,e){var n=t("lodash._createwrapper"),r=t("lodash._replaceholders"),i=t("lodash.restparam"),o=1,s=32,a=i(function(t,e,i){var u=o;if(i.length){var c=r(i,a.placeholder);u|=s}return n(t,u,e,i,c)});a.placeholder={},e.exports=a},{"lodash._createwrapper":63,"lodash._replaceholders":66,"lodash.restparam":67}],63:[function(t,e){(function(n){function r(t,e,n){for(var r=n.length,i=-1,o=j(t.length-r,0),s=-1,a=e.length,u=Array(o+a);++s<a;)u[s]=e[s];for(;++i<r;)u[n[i]]=t[i];for(;o--;)u[s++]=t[i++];return u}function i(t,e,n){for(var r=-1,i=n.length,o=-1,s=j(t.length-i,0),a=-1,u=e.length,c=Array(s+u);++o<s;)c[o]=t[o];for(var l=o;++a<u;)c[l+a]=e[a];for(;++r<i;)c[l+n[r]]=t[o++];return c}function o(t,e){function r(){var o=this&&this!==n&&this instanceof r?i:t;return o.apply(e,arguments)}var i=s(t);return r}function s(t){return function(){var e=d(t.prototype),n=t.apply(e,arguments);return f(n)?n:e}}function a(t,e,o,u,c,l,f,d,k,P){function S(){for(var y=arguments.length,b=y,_=Array(y);b--;)_[b]=arguments[b];if(u&&(_=r(_,u,c)),l&&(_=i(_,l,f)),I||R){var E=S.placeholder,C=g(_,E);if(y-=C.length,P>y){var N=d?p(d):null,q=j(P-y,0),D=I?C:null,U=I?null:C,F=I?_:null,z=I?null:_;e|=I?w:x,e&=~(I?x:w),L||(e&=~(v|m));var Y=a(t,e,o,F,D,z,U,N,k,q);return Y.placeholder=E,Y}}var W=T?o:this;O&&(t=W[B]),d&&(_=h(_,d)),A&&k<_.length&&(_.length=k);var $=this&&this!==n&&this instanceof S?M||s(t):t;return $.apply(W,_)}var A=e&E,T=e&v,O=e&m,I=e&b,L=e&y,R=e&_,M=!O&&s(t),B=t;return S}function u(t,e,r,i){function o(){for(var e=-1,s=arguments.length,c=-1,l=i.length,h=Array(s+l);++c<l;)h[c]=i[c];for(;s--;)h[c++]=arguments[++e];var f=this&&this!==n&&this instanceof o?u:t;return f.apply(a?r:this,h)}var a=e&v,u=s(t);return o}function c(t,e,n,r,i,s,c,l){var h=e&m;if(!h&&"function"!=typeof t)throw new TypeError(k);var f=r?r.length:0;if(f||(e&=~(w|x),r=i=null),f-=i?i.length:0,e&x){var p=r,d=i;r=i=null}var g=[t,e,n,r,i,p,d,s,c,l];if(g[9]=null==l?h?0:t.length:j(l-f,0)||0,e==v)var y=o(g[0],g[2]);else y=e!=w&&e!=(v|w)||g[4].length?a.apply(void 0,g):u.apply(void 0,g);return y}function l(t,e){return t=+t,e=null==e?S:e,t>-1&&t%1==0&&e>t}function h(t,e){for(var n=t.length,r=P(e.length,n),i=p(t);r--;){var o=e[r];t[r]=l(o,n)?i[o]:void 0}return t}function f(t){var e=typeof t;return"function"==e||!!t&&"object"==e}var p=t("lodash._arraycopy"),d=t("lodash._basecreate"),g=t("lodash._replaceholders"),v=1,m=2,y=4,b=8,_=16,w=32,x=64,E=128,k="Expected a function",j=Math.max,P=Math.min,S=Math.pow(2,53)-1;e.exports=c}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"lodash._arraycopy":64,"lodash._basecreate":65,"lodash._replaceholders":66}],64:[function(t,e){function n(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}e.exports=n},{}],65:[function(t,e){(function(t){function n(t){var e=typeof t;return"function"==e||!!t&&"object"==e}var r=function(){function e(){}return function(r){if(n(r)){e.prototype=r;var i=new e;e.prototype=null}return i||t.Object()}}();e.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],66:[function(t,e){function n(t,e){for(var n=-1,i=t.length,o=-1,s=[];++n<i;)t[n]===e&&(t[n]=r,s[++o]=n);return s}var r="__lodash_placeholder__";e.exports=n},{}],67:[function(t,e,n){arguments[4][58][0].apply(n,arguments)},{dup:58}],68:[function(t,e){function n(t){return"string"==typeof t?t:null==t?"":t+""}function r(t){return!!t&&"object"==typeof t}function i(t){return"number"==typeof t&&t>-1&&t%1==0&&m>=t}function o(t){return null==t?!1:d.call(t)==u?g.test(p.call(t)):r(t)&&h.test(t)}function s(t){return t=n(t),t&&l.test(t)?t.replace(c,"\\$&"):t}var a="[object Array]",u="[object Function]",c=/[.*+?^${}()|[\]\/\\]/g,l=RegExp(c.source),h=/^\[object .+?Constructor\]$/,f=Object.prototype,p=Function.prototype.toString,d=f.toString,g=RegExp("^"+s(d).replace(/toString|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),v=o(v=Array.isArray)&&v,m=Math.pow(2,53)-1,y=v||function(t){return r(t)&&i(t.length)&&d.call(t)==a};e.exports=y},{}],69:[function(t,e){function n(t,e){e||(e={}),this.cid||(this.cid=s("state")),this._events={},this._values={},this._definition=Object.create(this._definition),e.parse&&(t=this.parse(t,e)),this.parent=e.parent,this.collection=e.collection,this._keyTree=new T,this._initCollections(),this._initChildren(),this._cache={},this._previousAttributes={},t&&this.set(t,a({silent:!0,initial:!0},e)),this._changed={},this._derived&&this._initDerived(),e.init!==!1&&this.initialize.apply(this,arguments)}function r(t,e,n,r){var i,o,s=t._definition[e]={};if(f(n))i=t._ensureValidType(n),i&&(s.type=i);else{if(d(n)&&(o=n,n={type:o[0],required:o[1],default:o[2]}),i=t._ensureValidType(n.type),i&&(s.type=i),n.required&&(s.required=!0),n.default&&"object"==typeof n.default)throw new TypeError("The default value for "+e+" cannot be an object/array, must be a value or a function which returns a value/object/array");s.default=n.default,s.allowNull=n.allowNull?n.allowNull:!1,n.setOnce&&(s.setOnce=!0),s.required&&v(s.default)&&!s.setOnce&&(s.default=t._getDefaultForType(i)),s.test=n.test,s.values=n.values}return r&&(s.session=!0),Object.defineProperty(t,e,{set:function(t){this.set(e,t)},get:function(){var t=this._values[e],n=this._dataTypes[s.type];return"undefined"!=typeof t?(n&&n.get&&(t=n.get(t)),t):(t=E(s,"default"),this._values[e]=t,t)}}),s}function i(t,e,n){var r=t._derived[e]={fn:m(n)?n:n.fn,cache:n.cache!==!1,depList:n.deps||[]};l(r.depList,function(n){t._deps[n]=S(t._deps[n]||[],[e])}),Object.defineProperty(t,e,{get:function(){return this._getDerivedProperty(e)},set:function(){throw new TypeError('"'+e+"\" is a derived property, it can't be set directly.")}})}function o(t){var e,n=this,o=[].slice.call(arguments);e=t&&t.hasOwnProperty("constructor")?t.constructor:function(){return n.apply(this,arguments)},a(e,n);var s=function(){this.constructor=e};if(s.prototype=n.prototype,e.prototype=new s,e.prototype._derived=a({},n.prototype._derived),e.prototype._deps=a({},n.prototype._deps),e.prototype._definition=a({},n.prototype._definition),e.prototype._collections=a({},n.prototype._collections),e.prototype._children=a({},n.prototype._children),e.prototype._dataTypes=a({},n.prototype._dataTypes||L),t){var c=["dataTypes","props","session","derived","collections","children"];o.forEach(function(t){t.dataTypes&&l(t.dataTypes,function(t,n){e.prototype._dataTypes[n]=t}),t.props&&l(t.props,function(t,n){r(e.prototype,n,t)}),t.session&&l(t.session,function(t,n){r(e.prototype,n,t,!0)}),t.derived&&l(t.derived,function(t,n){i(e.prototype,n,t)}),t.collections&&l(t.collections,function(t,n){e.prototype._collections[n]=t}),t.children&&l(t.children,function(t,n){e.prototype._children[n]=t}),a(e.prototype,u(t,c))})}return e.__super__=n.prototype,e}"undefined"!=typeof window&&(window.ampersand=window.ampersand||{},window.ampersand["ampersand-state"]=window.ampersand["ampersand-state"]||[],window.ampersand["ampersand-state"].push("4.5.4"));var s=t("lodash.uniqueid"),a=t("lodash.assign"),u=t("lodash.omit"),c=t("lodash.escape"),l=t("lodash.foreach"),h=t("lodash.includes"),f=t("lodash.isstring"),p=t("lodash.isobject"),d=t("lodash.isarray"),g=t("lodash.isdate"),v=t("lodash.isundefined"),m=t("lodash.isfunction"),y=t("lodash.isnull"),b=t("lodash.isempty"),_=t("lodash.isequal"),w=t("lodash.clone"),x=t("lodash.has"),E=t("lodash.result"),k=t("lodash.keys"),j=t("lodash.bind"),P=t("lodash.defaults"),S=t("lodash.union"),A=t("ampersand-events"),T=t("key-tree-store"),O=t("array-next"),I=/^change:/;a(n.prototype,A,{extraProperties:"ignore",idAttribute:"id",namespaceAttribute:"namespace",typeAttribute:"modelType",initialize:function(){return this},getId:function(){return this[this.idAttribute]},getNamespace:function(){return this[this.namespaceAttribute]},getType:function(){return this[this.typeAttribute]},isNew:function(){return null==this.getId()},escape:function(t){return c(this.get(t))},isValid:function(t){return this._validate({},a(t||{},{validate:!0}))},parse:function(t){return t},serialize:function(){var t=this.getAttributes({props:!0},!0);return l(this._children,function(e,n){t[n]=this[n].serialize()},this),l(this._collections,function(e,n){t[n]=this[n].serialize()},this),t},set:function(t,e,n){var r,i,o,s,a,u,c,f,d,g,m,b,_,w,x,E,k=this,j=this.extraProperties;if(p(t)||null===t?(d=t,n=e):(d={},d[t]=e),n=n||{},!this._validate(d,n))return!1;b=n.unset,m=n.silent,w=n.initial,i=[],r=this._changing,this._changing=!0,r||(this._previousAttributes=this.attributes,this._changed={});for(f in d){if(s=d[f],o=typeof s,_=this._values[f],a=this._definition[f],!a){if(this._children[f]||this._collections[f]){this[f].set(s,n);continue}if("ignore"===j)continue;if("reject"===j)throw new TypeError('No "'+f+'" property defined on '+(this.type||"this")+' model and extraProperties not set to "ignore" or "allow"');if("allow"===j)a=this._createPropertyDefinition(f,"any");else if(j)throw new TypeError('Invalid value for extraProperties: "'+j+'"')}if(E=this._getCompareForType(a.type),g=this._dataTypes[a.type],g&&g.set&&(u=g.set(s),s=u.val,o=u.type),a.test&&(c=a.test.call(this,s,o)))throw new TypeError("Property '"+f+"' failed validation with error: "+c);if(v(s)&&a.required)throw new TypeError("Required property '"+f+"' must be of type "+a.type+". Tried to set "+s);if(y(s)&&a.required&&!a.allowNull)throw new TypeError("Property '"+f+"' must be of type "+a.type+" (cannot be null). Tried to set "+s);if(a.type&&"any"!==a.type&&a.type!==o&&!y(s)&&!v(s))throw new TypeError("Property '"+f+"' must be of type "+a.type+". Tried to set "+s);if(a.values&&!h(a.values,s))throw new TypeError("Property '"+f+"' must be one of values: "+a.values.join(", ")+". Tried to set "+s);if(x=!E(_,s,f),a.setOnce&&void 0!==_&&x&&!w)throw new TypeError("Property '"+f+"' can only be set once.");x?(i.push({prev:_,val:s,key:f}),k._changed[f]=s):delete k._changed[f]}if(l(i,function(t){k._previousAttributes[t.key]=t.prev,b?delete k._values[t.key]:k._values[t.key]=t.val}),!m&&i.length&&(k._pending=!0),m||l(i,function(t){k.trigger("change:"+t.key,k,t.val,n)}),r)return this;if(!m)for(;this._pending;)this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},get:function(t){return this[t]},toggle:function(t){var e=this._definition[t];if("boolean"===e.type)this[t]=!this[t];else{if(!e||!e.values)throw new TypeError("Can only toggle properties that are type `boolean` or have `values` array.");this[t]=O(e.values,this[t])}return this},previousAttributes:function(){return w(this._previousAttributes)},hasChanged:function(t){return null==t?!b(this._changed):x(this._changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?w(this._changed):!1;var e,n,r,i=!1,o=this._changing?this._previousAttributes:this.attributes;for(var s in t)n=this._definition[s],n&&(r=this._getCompareForType(n.type),r(o[s],e=t[s])||((i||(i={}))[s]=e));return i},toJSON:function(){return this.serialize()},unset:function(t,e){t=Array.isArray(t)?t:[t],l(t,function(t){var n,r=this._definition[t];return r.required?(n=E(r,"default"),this.set(t,n,e)):this.set(t,n,a({},e,{unset:!0}))},this)},clear:function(t){var e=this;return l(k(this.attributes),function(n){e.unset(n,t)}),this},previous:function(t){return null!=t&&Object.keys(this._previousAttributes).length?this._previousAttributes[t]:null},_getDefaultForType:function(t){var e=this._dataTypes[t];return e&&e.default},_getCompareForType:function(t){var e=this._dataTypes[t];return e&&e.compare?j(e.compare,this):_},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=a({},this.attributes,t);var n=this.validationError=this.validate(t,e)||null;return n?(this.trigger("invalid",this,n,a(e||{},{validationError:n})),!1):!0},_createPropertyDefinition:function(t,e,n){return r(this,t,e,n)},_ensureValidType:function(t){return h(["string","number","boolean","array","object","date","any"].concat(k(this._dataTypes)),t)?t:void 0},getAttributes:function(t,e){t||(t={}),P(t,{session:!1,props:!1,derived:!1});var n,r,i,o={};for(r in this._definition)i=this._definition[r],(t.session&&i.session||t.props&&!i.session)&&(n=e?this._values[r]:this[r],"undefined"==typeof n&&(n=E(i,"default")),"undefined"!=typeof n&&(o[r]=n));if(t.derived)for(r in this._derived)o[r]=this[r];return o},_initDerived:function(){var t=this;l(this._derived,function(e,n){var r=t._derived[n];r.deps=r.depList;var i=function(e){e=e||{};var i=r.fn.call(t);t._cache[n]===i&&r.cache||(r.cache&&(t._previousAttributes[n]=t._cache[n]),t._cache[n]=i,t.trigger("change:"+n,t,t._cache[n]))};r.deps.forEach(function(e){t._keyTree.add(e,i)})}),this.on("all",function(e){I.test(e)&&t._keyTree.get(e.split(":")[1]).forEach(function(t){t()})},this)},_getDerivedProperty:function(t,e){return this._derived[t].cache?((e||!this._cache.hasOwnProperty(t))&&(this._cache[t]=this._derived[t].fn.apply(this)),this._cache[t]):this._derived[t].fn.apply(this)},_initCollections:function(){var t;if(this._collections)for(t in this._collections)this[t]=new this._collections[t](null,{parent:this})},_initChildren:function(){var t;if(this._children)for(t in this._children)this[t]=new this._children[t]({},{parent:this}),this.listenTo(this[t],"all",this._getEventBubblingHandler(t))},_getEventBubblingHandler:function(t){return j(function(e,n,r){I.test(e)?this.trigger("change:"+t+"."+e.split(":")[1],n,r):"change"===e&&this.trigger("change",this)},this)},_verifyRequired:function(){var t=this.attributes;for(var e in this._definition)if(this._definition[e].required&&"undefined"==typeof t[e])return!1;return!0}}),Object.defineProperties(n.prototype,{attributes:{get:function(){return this.getAttributes({props:!0,session:!0})}},all:{get:function(){return this.getAttributes({session:!0,props:!0,derived:!0})}},isState:{get:function(){return!0},set:function(){}}});var L={string:{default:function(){return""}},date:{set:function(t){var e;if(null==t)e="object";else if(g(t))e="date",t=t.valueOf();else try{var n=new Date(t).valueOf();if(isNaN(n)&&(n=new Date(parseInt(t,10)).valueOf(),isNaN(n)))throw TypeError;t=n,e="date"}catch(n){e=typeof t}return{val:t,type:e}},
get:function(t){return null==t?t:new Date(t)},default:function(){return new Date}},array:{set:function(t){return{val:t,type:d(t)?"array":typeof t}},default:function(){return[]}},object:{set:function(t){var e=typeof t;return"object"!==e&&v(t)&&(t=null,e="object"),{val:t,type:e}},default:function(){return{}}},state:{set:function(t){var e=t instanceof n||t&&t.isState;return e?{val:t,type:"state"}:{val:t,type:typeof t}},compare:function(t,e,n){var r=t===e;return r||(t&&this.stopListening(t),null!=e&&this.listenTo(e,"all",this._getEventBubblingHandler(n))),r}}};n.extend=o,e.exports=n},{"ampersand-events":70,"array-next":73,"key-tree-store":74,"lodash.assign":75,"lodash.bind":83,"lodash.clone":89,"lodash.defaults":99,"lodash.escape":101,"lodash.foreach":103,"lodash.has":107,"lodash.includes":111,"lodash.isarray":115,"lodash.isdate":116,"lodash.isempty":117,"lodash.isequal":119,"lodash.isfunction":123,"lodash.isnull":124,"lodash.isobject":125,"lodash.isstring":126,"lodash.isundefined":127,"lodash.keys":128,"lodash.omit":131,"lodash.result":147,"lodash.union":151,"lodash.uniqueid":160}],70:[function(t,e,n){arguments[4][36][0].apply(n,arguments)},{dup:36,"lodash.assign":75,"lodash.bind":83,"lodash.foreach":103,"lodash.isempty":117,"lodash.keys":128,"lodash.once":71,"lodash.uniqueid":160}],71:[function(t,e,n){arguments[4][48][0].apply(n,arguments)},{dup:48,"lodash.before":72}],72:[function(t,e,n){arguments[4][49][0].apply(n,arguments)},{dup:49}],73:[function(t,e){e.exports=function(t,e){var n=t.length,r=t.indexOf(e)+1;return r>n-1&&(r=0),t[r]}},{}],74:[function(t,e){function n(){this.storage={}}var r=Array.prototype.slice;n.prototype.add=function(t,e){var n=this.storage[t]||(this.storage[t]=[]);n.push(e)},n.prototype.remove=function(t){var e,n;for(e in this.storage)n=this.storage[e],n.some(function(e,r){return e===t?(n.splice(r,1),!0):void 0})},n.prototype.get=function(t){var e,n=[];for(e in this.storage)t&&t!==e&&0!==e.indexOf(t+".")||(n=n.concat(this.storage[e]));return n},n.prototype.getGrouped=function(t){var e,n={};for(e in this.storage)t&&t!==e&&0!==e.indexOf(t+".")||(n[e]=r.call(this.storage[e]));return n},n.prototype.getAll=function(t){var e,n={};for(e in this.storage)(t===e||0===e.indexOf(t+"."))&&(n[e]=r.call(this.storage[e]));return n},n.prototype.run=function(t,e){var n=r.call(arguments,2);this.get(t).forEach(function(t){t.apply(e||this,n)})},e.exports=n},{}],75:[function(t,e,n){arguments[4][52][0].apply(n,arguments)},{dup:52,"lodash._baseassign":76,"lodash._createassigner":78,"lodash.isnative":82,"lodash.keys":128}],76:[function(t,e,n){arguments[4][53][0].apply(n,arguments)},{dup:53,"lodash._basecopy":77,"lodash.isnative":82,"lodash.keys":128}],77:[function(t,e,n){arguments[4][54][0].apply(n,arguments)},{dup:54}],78:[function(t,e,n){arguments[4][55][0].apply(n,arguments)},{dup:55,"lodash._bindcallback":79,"lodash._isiterateecall":80,"lodash.restparam":81}],79:[function(t,e,n){arguments[4][40][0].apply(n,arguments)},{dup:40}],80:[function(t,e,n){arguments[4][57][0].apply(n,arguments)},{dup:57}],81:[function(t,e,n){arguments[4][58][0].apply(n,arguments)},{dup:58}],82:[function(t,e,n){arguments[4][47][0].apply(n,arguments)},{dup:47}],83:[function(t,e,n){arguments[4][62][0].apply(n,arguments)},{dup:62,"lodash._createwrapper":84,"lodash._replaceholders":87,"lodash.restparam":88}],84:[function(t,e,n){arguments[4][63][0].apply(n,arguments)},{dup:63,"lodash._arraycopy":85,"lodash._basecreate":86,"lodash._replaceholders":87}],85:[function(t,e,n){arguments[4][64][0].apply(n,arguments)},{dup:64}],86:[function(t,e,n){arguments[4][65][0].apply(n,arguments)},{dup:65}],87:[function(t,e,n){arguments[4][66][0].apply(n,arguments)},{dup:66}],88:[function(t,e,n){arguments[4][58][0].apply(n,arguments)},{dup:58}],89:[function(t,e){function n(t,e,n,s){return e&&"boolean"!=typeof e&&o(t,e,n)?e=!1:"function"==typeof e&&(s=n,n=e,e=!1),n="function"==typeof n&&i(n,s,1),r(t,e,n)}var r=t("lodash._baseclone"),i=t("lodash._bindcallback"),o=t("lodash._isiterateecall");e.exports=n},{"lodash._baseclone":90,"lodash._bindcallback":97,"lodash._isiterateecall":98}],90:[function(t,e){(function(n){function r(t,e,n,o,l,d,v){var m;if(n&&(m=l?n(t,o,l):n(t)),void 0!==m)return m;if(!c(t))return t;var b=g(t);if(b){if(m=s(t),!e)return h(t,m)}else{var _=$.call(t),w=_==E;if(_!=P&&_!=y&&(!w||l))return z[_]?u(t,_,e):l?t:{};if(m=a(w?{}:t),!e)return p(m,t)}d||(d=[]),v||(v=[]);for(var x=d.length;x--;)if(d[x]==t)return v[x];return d.push(t),v.push(m),(b?f:i)(t,function(i,o){m[o]=r(i,e,n,o,t,d,v)}),m}function i(t,e){return d(t,e,m)}function o(t){return J.call(t,0)}function s(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&W.call(t,"index")&&(n.index=t.index,n.input=t.input),n}function a(t){var e=t.constructor;return"function"==typeof e&&e instanceof e||(e=Object),new e}function u(t,e,n){var r=t.constructor;switch(e){case I:return o(t);case _:case w:return new r(+t);case L:case R:case M:case B:case C:case N:case q:case D:case U:var i=t.buffer;return new r(n?o(i):i,t.byteOffset,t.length);case j:case T:return new r(t);case S:var s=new r(t.source,F.exec(t));s.lastIndex=t.lastIndex}return s}function c(t){var e=typeof t;return"function"==e||!!t&&"object"==e}function l(t){return function(){return t}}var h=t("lodash._arraycopy"),f=t("lodash._arrayeach"),p=t("lodash._baseassign"),d=t("lodash._basefor"),g=t("lodash.isarray"),v=t("lodash.isnative"),m=t("lodash.keys"),y="[object Arguments]",b="[object Array]",_="[object Boolean]",w="[object Date]",x="[object Error]",E="[object Function]",k="[object Map]",j="[object Number]",P="[object Object]",S="[object RegExp]",A="[object Set]",T="[object String]",O="[object WeakMap]",I="[object ArrayBuffer]",L="[object Float32Array]",R="[object Float64Array]",M="[object Int8Array]",B="[object Int16Array]",C="[object Int32Array]",N="[object Uint8Array]",q="[object Uint8ClampedArray]",D="[object Uint16Array]",U="[object Uint32Array]",F=/\w*$/,z={};z[y]=z[b]=z[I]=z[_]=z[w]=z[L]=z[R]=z[M]=z[B]=z[C]=z[j]=z[P]=z[S]=z[T]=z[N]=z[q]=z[D]=z[U]=!0,z[x]=z[E]=z[k]=z[A]=z[O]=!1;var Y=Object.prototype,W=Y.hasOwnProperty,$=Y.toString,H=v(H=n.ArrayBuffer)&&H,J=v(J=H&&new H(0).slice)&&J,G=Math.floor,V=v(V=n.Uint8Array)&&V,K=function(){try{var t=v(t=n.Float64Array)&&t,e=new t(new H(10),0,1)&&t}catch(t){}return e}(),Q=K?K.BYTES_PER_ELEMENT:0;J||(o=H&&V?function(t){var e=t.byteLength,n=K?G(e/Q):0,r=n*Q,i=new H(e);if(n){var o=new K(i,0,n);o.set(new K(t,0,n))}return e!=r&&(o=new V(i,r),o.set(new V(t,r))),i}:l(null)),e.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"lodash._arraycopy":91,"lodash._arrayeach":92,"lodash._baseassign":93,"lodash._basefor":95,"lodash.isarray":115,"lodash.isnative":96,"lodash.keys":128}],91:[function(t,e,n){arguments[4][64][0].apply(n,arguments)},{dup:64}],92:[function(t,e,n){arguments[4][38][0].apply(n,arguments)},{dup:38}],93:[function(t,e,n){arguments[4][53][0].apply(n,arguments)},{dup:53,"lodash._basecopy":94,"lodash.isnative":96,"lodash.keys":128}],94:[function(t,e,n){arguments[4][54][0].apply(n,arguments)},{dup:54}],95:[function(t,e){function n(t){return function(e,n,i){for(var o=r(e),s=i(e),a=s.length,u=t?a:-1;t?u--:++u<a;){var c=s[u];if(n(o[c],c,o)===!1)break}return e}}function r(t){return i(t)?t:Object(t)}function i(t){var e=typeof t;return"function"==e||!!t&&"object"==e}var o=n();e.exports=o},{}],96:[function(t,e,n){arguments[4][47][0].apply(n,arguments)},{dup:47}],97:[function(t,e,n){arguments[4][40][0].apply(n,arguments)},{dup:40}],98:[function(t,e,n){arguments[4][57][0].apply(n,arguments)},{dup:57}],99:[function(t,e){function n(t,e){return void 0===t?e:t}var r=t("lodash.assign"),i=t("lodash.restparam"),o=i(function(t){var e=t[0];return null==e?e:(t.push(n),r.apply(void 0,t))});e.exports=o},{"lodash.assign":75,"lodash.restparam":100}],100:[function(t,e,n){arguments[4][58][0].apply(n,arguments)},{dup:58}],101:[function(t,e){function n(t){return a[t]}function r(t){return t=i(t),t&&s.test(t)?t.replace(o,n):t}var i=t("lodash._basetostring"),o=/[&<>"'`]/g,s=RegExp(o.source),a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"};e.exports=r},{"lodash._basetostring":102}],102:[function(t,e,n){arguments[4][51][0].apply(n,arguments)},{dup:51}],103:[function(t,e,n){arguments[4][37][0].apply(n,arguments)},{dup:37,"lodash._arrayeach":104,"lodash._baseeach":105,"lodash._bindcallback":106,"lodash.isarray":115}],104:[function(t,e,n){arguments[4][38][0].apply(n,arguments)},{dup:38}],105:[function(t,e,n){arguments[4][39][0].apply(n,arguments)},{dup:39,"lodash.keys":128}],106:[function(t,e,n){arguments[4][40][0].apply(n,arguments)},{dup:40}],107:[function(t,e){function n(t,e){var n=typeof t;if("string"==n&&f.test(t)||"number"==n)return!0;if(l(t))return!1;var i=!h.test(t);return i||null!=e&&t in r(e)}function r(t){return o(t)?t:Object(t)}function i(t){var e=t?t.length:0;return e?t[e-1]:void 0}function o(t){var e=typeof t;return"function"==e||!!t&&"object"==e}function s(t,e){if(null==t)return!1;var r=d.call(t,e);return r||n(e)||(e=c(e),t=1==e.length?t:a(t,u(e,0,-1)),e=i(e),r=null!=t&&d.call(t,e)),r}var a=t("lodash._baseget"),u=t("lodash._baseslice"),c=t("lodash._topath"),l=t("lodash.isarray"),h=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,f=/^\w*$/,p=Object.prototype,d=p.hasOwnProperty;e.exports=s},{"lodash._baseget":108,"lodash._baseslice":109,"lodash._topath":110,"lodash.isarray":115}],108:[function(t,e){function n(t,e,n){if(null!=t){void 0!==n&&n in r(t)&&(e=[n]);for(var i=-1,o=e.length;null!=t&&++i<o;)t=t[e[i]];return i&&i==o?t:void 0}}function r(t){return i(t)?t:Object(t)}function i(t){var e=typeof t;return"function"==e||!!t&&"object"==e}e.exports=n},{}],109:[function(t,e){function n(t,e,n){var r=-1,i=t.length;e=null==e?0:+e||0,0>e&&(e=-e>i?0:i+e),n=void 0===n||n>i?i:+n||0,0>n&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0;for(var o=Array(i);++r<i;)o[r]=t[r+e];return o}e.exports=n},{}],110:[function(t,e){function n(t){return"string"==typeof t?t:null==t?"":t+""}function r(t){if(i(t))return t;var e=[];return n(t).replace(o,function(t,n,r,i){e.push(r?i.replace(s,"$1"):n||t)}),e}var i=t("lodash.isarray"),o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,s=/\\(\\)?/g;e.exports=r},{"lodash.isarray":115}],111:[function(t,e){function n(t){return function(e){return null==e?void 0:e[t]}}function r(t){return"number"==typeof t&&t>-1&&t%1==0&&p>=t}function i(t,e,n,i){var a=t?d(t):0;return r(a)||(t=o(t),a=t.length),a?(n="number"!=typeof n||i&&u(e,n,i)?0:0>n?f(a+n,0):n||0,"string"==typeof t||!c(t)&&l(t)?a>n&&t.indexOf(e,n)>-1:s(t,e,n)>-1):!1}function o(t){return a(t,h(t))}var s=t("lodash._baseindexof"),a=t("lodash._basevalues"),u=t("lodash._isiterateecall"),c=t("lodash.isarray"),l=t("lodash.isstring"),h=t("lodash.keys"),f=Math.max,p=Math.pow(2,53)-1,d=n("length");e.exports=i},{"lodash._baseindexof":112,"lodash._basevalues":113,"lodash._isiterateecall":114,"lodash.isarray":115,"lodash.isstring":126,"lodash.keys":128}],112:[function(t,e){function n(t,e,n){if(e!==e)return r(t,n);for(var i=n-1,o=t.length;++i<o;)if(t[i]===e)return i;return-1}function r(t,e,n){for(var r=t.length,i=e+(n?0:-1);n?i--:++i<r;){var o=t[i];if(o!==o)return i}return-1}e.exports=n},{}],113:[function(t,e){function n(t,e){for(var n=-1,r=e.length,i=Array(r);++n<r;)i[n]=t[e[n]];return i}e.exports=n},{}],114:[function(t,e,n){arguments[4][57][0].apply(n,arguments)},{dup:57}],115:[function(t,e,n){arguments[4][68][0].apply(n,arguments)},{dup:68}],116:[function(t,e){function n(t){return!!t&&"object"==typeof t}function r(t){return n(t)&&s.call(t)==i}var i="[object Date]",o=Object.prototype,s=o.toString;e.exports=r},{}],117:[function(t,e,n){arguments[4][41][0].apply(n,arguments)},{dup:41,"lodash.isarguments":118,"lodash.isarray":115,"lodash.isfunction":123,"lodash.isstring":126,"lodash.keys":128}],118:[function(t,e,n){arguments[4][42][0].apply(n,arguments)},{dup:42}],119:[function(t,e){function n(t){return t===t&&!i(t)}function r(t,e,r,i){if(r="function"==typeof r&&s(r,i,3),!r&&n(t)&&n(e))return t===e;var a=r?r(t,e):void 0;return void 0===a?o(t,e,r):!!a}function i(t){var e=typeof t;return"function"==e||!!t&&"object"==e}var o=t("lodash._baseisequal"),s=t("lodash._bindcallback");e.exports=r},{"lodash._baseisequal":120,"lodash._bindcallback":122}],120:[function(t,e){function n(t,e,i,o,s,a){if(t===e)return!0;var u=typeof t,c=typeof e;return"function"!=u&&"object"!=u&&"function"!=c&&"object"!=c||null==t||null==e?t!==t&&e!==e:r(t,e,n,i,o,s,a)}function r(t,e,n,r,c,f,p){var d=a(t),g=a(e),m=h,y=h;d||(m=w.call(t),m==l?m=v:m!=v&&(d=u(t))),g||(y=w.call(e),y==l?y=v:y!=v&&(g=u(e)));var b=m==v,x=y==v,E=m==y;if(E&&!d&&!b)return o(t,e,m);if(!c){var k=b&&_.call(t,"__wrapped__"),j=x&&_.call(e,"__wrapped__");if(k||j)return n(k?t.value():t,j?e.value():e,r,c,f,p)}if(!E)return!1;f||(f=[]),p||(p=[]);for(var P=f.length;P--;)if(f[P]==t)return p[P]==e;f.push(t),p.push(e);var S=(d?i:s)(t,e,n,r,c,f,p);return f.pop(),p.pop(),S}function i(t,e,n,r,i,o,s){var a=-1,u=t.length,c=e.length,l=!0;if(u!=c&&!(i&&c>u))return!1;for(;l&&++a<u;){var h=t[a],f=e[a];if(l=void 0,r&&(l=i?r(f,h,a):r(h,f,a)),void 0===l)if(i)for(var p=c;p--&&(f=e[p],!(l=h&&h===f||n(h,f,r,i,o,s))););else l=h&&h===f||n(h,f,r,i,o,s)}return!!l}function o(t,e,n){switch(n){case f:case p:return+t==+e;case d:return t.name==e.name&&t.message==e.message;case g:return t!=+t?e!=+e:t==+e;case m:case y:return t==e+""}return!1}function s(t,e,n,r,i,o,s){var a=c(t),u=a.length,l=c(e),h=l.length;if(u!=h&&!i)return!1;for(var f=i,p=-1;++p<u;){var d=a[p],g=i?d in e:_.call(e,d);if(g){var v=t[d],m=e[d];g=void 0,r&&(g=i?r(m,v,d):r(v,m,d)),void 0===g&&(g=v&&v===m||n(v,m,r,i,o,s))}if(!g)return!1;f||(f="constructor"==d)}if(!f){var y=t.constructor,b=e.constructor;if(y!=b&&"constructor"in t&&"constructor"in e&&!("function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b))return!1}return!0}var a=t("lodash.isarray"),u=t("lodash.istypedarray"),c=t("lodash.keys"),l="[object Arguments]",h="[object Array]",f="[object Boolean]",p="[object Date]",d="[object Error]",g="[object Number]",v="[object Object]",m="[object RegExp]",y="[object String]",b=Object.prototype,_=b.hasOwnProperty,w=b.toString;e.exports=n},{"lodash.isarray":115,"lodash.istypedarray":121,"lodash.keys":128}],121:[function(t,e){function n(t){return!!t&&"object"==typeof t}function r(t){return"number"==typeof t&&t>-1&&t%1==0&&I>=t}function i(t){return n(t)&&r(t.length)&&!!A[O.call(t)]}var o="[object Arguments]",s="[object Array]",a="[object Boolean]",u="[object Date]",c="[object Error]",l="[object Function]",h="[object Map]",f="[object Number]",p="[object Object]",d="[object RegExp]",g="[object Set]",v="[object String]",m="[object WeakMap]",y="[object ArrayBuffer]",b="[object Float32Array]",_="[object Float64Array]",w="[object Int8Array]",x="[object Int16Array]",E="[object Int32Array]",k="[object Uint8Array]",j="[object Uint8ClampedArray]",P="[object Uint16Array]",S="[object Uint32Array]",A={};A[b]=A[_]=A[w]=A[x]=A[E]=A[k]=A[j]=A[P]=A[S]=!0,A[o]=A[s]=A[y]=A[a]=A[u]=A[c]=A[l]=A[h]=A[f]=A[p]=A[d]=A[g]=A[v]=A[m]=!1;var T=Object.prototype,O=T.toString,I=Math.pow(2,53)-1;e.exports=i},{}],122:[function(t,e,n){arguments[4][40][0].apply(n,arguments)},{dup:40}],123:[function(t,e,n){arguments[4][43][0].apply(n,arguments)},{dup:43}],124:[function(t,e){function n(t){return null===t}e.exports=n},{}],125:[function(t,e){function n(t){var e=typeof t;return"function"==e||!!t&&"object"==e}e.exports=n},{}],126:[function(t,e,n){arguments[4][44][0].apply(n,arguments)},{dup:44}],127:[function(t,e){function n(t){return void 0===t}e.exports=n},{}],128:[function(t,e,n){arguments[4][45][0].apply(n,arguments)},{dup:45,"lodash.isarguments":129,"lodash.isarray":115,"lodash.isnative":130}],129:[function(t,e,n){arguments[4][42][0].apply(n,arguments)},{dup:42}],130:[function(t,e,n){arguments[4][47][0].apply(n,arguments)},{dup:47}],131:[function(t,e){var n=t("lodash._arraymap"),r=t("lodash._basedifference"),i=t("lodash._baseflatten"),o=t("lodash._bindcallback"),s=t("lodash._pickbyarray"),a=t("lodash._pickbycallback"),u=t("lodash.keysin"),c=t("lodash.restparam"),l=c(function(t,e){if(null==t)return{};if("function"!=typeof e[0]){var e=n(i(e),String);return s(t,r(u(t),e))}var c=o(e[0],e[1],3);return a(t,function(t,e,n){return!c(t,e,n)})});e.exports=l},{"lodash._arraymap":132,"lodash._basedifference":133,"lodash._baseflatten":138,"lodash._bindcallback":140,"lodash._pickbyarray":141,"lodash._pickbycallback":142,"lodash.keysin":144,"lodash.restparam":146}],132:[function(t,e){function n(t,e){for(var n=-1,r=t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}e.exports=n},{}],133:[function(t,e){function n(t,e){var n=t?t.length:0,s=[];if(!n)return s;var a=-1,u=r,c=!0,l=c&&e.length>=200?o(e):null,h=e.length;l&&(u=i,c=!1,e=l);t:for(;++a<n;){var f=t[a];if(c&&f===f){for(var p=h;p--;)if(e[p]===f)continue t;s.push(f)}else u(e,f,0)<0&&s.push(f)}return s}var r=t("lodash._baseindexof"),i=t("lodash._cacheindexof"),o=t("lodash._createcache");e.exports=n},{"lodash._baseindexof":134,"lodash._cacheindexof":135,"lodash._createcache":136}],134:[function(t,e,n){arguments[4][112][0].apply(n,arguments)},{dup:112}],135:[function(t,e){function n(t,e){var n=t.data,i="string"==typeof e||r(e)?n.set.has(e):n.hash[e];return i?0:-1}function r(t){var e=typeof t;return"function"==e||!!t&&"object"==e}e.exports=n},{}],136:[function(t,e){(function(n){function r(t){var e=t?t.length:0;for(this.data={hash:c(null),set:new u};e--;)this.push(t[e])}function i(t){var e=this.data;"string"==typeof t||o(t)?e.set.add(t):e.hash[t]=!0}function o(t){var e=typeof t;return"function"==e||!!t&&"object"==e}function s(t){return function(){return t}}var a=t("lodash.isnative"),u=a(u=n.Set)&&u,c=a(c=Object.create)&&c,l=c&&u?function(t){return new r(t)}:s(null);r.prototype.push=i,e.exports=l}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"lodash.isnative":137}],137:[function(t,e,n){arguments[4][47][0].apply(n,arguments)},{dup:47}],138:[function(t,e){function n(t){return!!t&&"object"==typeof t}function r(t,e,i){for(var s=-1,c=t.length,l=-1,h=[];++s<c;){var f=t[s];if(n(f)&&o(f)&&(i||u(f)||a(f))){e&&(f=r(f,e,i));for(var p=-1,d=f.length;++p<d;)h[++l]=f[p]}else i||(h[++l]=f)}return h}function i(t){return function(e){return null==e?void 0:e[t]}}function o(t){return null!=t&&s(l(t))}function s(t){return"number"==typeof t&&t>-1&&t%1==0&&c>=t}var a=t("lodash.isarguments"),u=t("lodash.isarray"),c=Math.pow(2,53)-1,l=i("length");e.exports=r},{"lodash.isarguments":139,"lodash.isarray":115}],139:[function(t,e,n){arguments[4][42][0].apply(n,arguments)},{dup:42}],140:[function(t,e,n){arguments[4][40][0].apply(n,arguments)},{dup:40}],141:[function(t,e){function n(t,e){t=r(t);for(var n=-1,i=e.length,o={};++n<i;){var s=e[n];s in t&&(o[s]=t[s])}return o}function r(t){return i(t)?t:Object(t)}function i(t){var e=typeof t;return"function"==e||!!t&&"object"==e}e.exports=n},{}],142:[function(t,e){function n(t,e){return i(t,e,o)}function r(t,e){var r={};return n(t,function(t,n,i){e(t,n,i)&&(r[n]=t)}),r}var i=t("lodash._basefor"),o=t("lodash.keysin");e.exports=r},{"lodash._basefor":143,"lodash.keysin":144}],143:[function(t,e,n){arguments[4][95][0].apply(n,arguments)},{dup:95}],144:[function(t,e){function n(t,e){return t=+t,e=null==e?h:e,t>-1&&t%1==0&&e>t}function r(t){return"number"==typeof t&&t>-1&&t%1==0&&h>=t}function i(t){var e=typeof t;return"function"==e||!!t&&"object"==e}function o(t){if(null==t)return[];i(t)||(t=Object(t));var e=t.length;e=e&&r(e)&&(a(t)||f.nonEnumArgs&&s(t))&&e||0;for(var o=t.constructor,u=-1,l="function"==typeof o&&o.prototype===t,h=Array(e),p=e>0;++u<e;)h[u]=u+"";for(var d in t)p&&n(d,e)||"constructor"==d&&(l||!c.call(t,d))||h.push(d);return h}var s=t("lodash.isarguments"),a=t("lodash.isarray"),u=Object.prototype,c=u.hasOwnProperty,l=u.propertyIsEnumerable,h=Math.pow(2,53)-1,f={};!function(t){var e=function(){this.x=t},n=arguments,r=[];e.prototype={valueOf:t,y:t};for(var i in new e)r.push(i);try{f.nonEnumArgs=!l.call(n,1)}catch(t){f.nonEnumArgs=!0}}(1,0),e.exports=o},{"lodash.isarguments":145,"lodash.isarray":115}],145:[function(t,e,n){arguments[4][42][0].apply(n,arguments)},{dup:42}],146:[function(t,e,n){arguments[4][58][0].apply(n,arguments)},{dup:58}],147:[function(t,e){function n(t,e){var n=typeof t;if("string"==n&&p.test(t)||"number"==n)return!0;if(l(t))return!1;var i=!f.test(t);return i||null!=e&&t in r(e)}function r(t){return o(t)?t:Object(t)}function i(t){var e=t?t.length:0;return e?t[e-1]:void 0}function o(t){var e=typeof t;return"function"==e||!!t&&"object"==e}function s(t,e,r){var o=null==t?void 0:t[e];return void 0===o&&(null==t||n(e,t)||(e=c(e),t=1==e.length?t:a(t,u(e,0,-1)),o=null==t?void 0:t[i(e)]),o=void 0===o?r:o),h(o)?o.call(t):o}var a=t("lodash._baseget"),u=t("lodash._baseslice"),c=t("lodash._topath"),l=t("lodash.isarray"),h=t("lodash.isfunction"),f=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,p=/^\w*$/;e.exports=s},{"lodash._baseget":148,"lodash._baseslice":149,"lodash._topath":150,"lodash.isarray":115,"lodash.isfunction":123}],148:[function(t,e,n){arguments[4][108][0].apply(n,arguments)},{dup:108}],149:[function(t,e,n){arguments[4][109][0].apply(n,arguments)},{dup:109}],150:[function(t,e,n){arguments[4][110][0].apply(n,arguments)},{dup:110,"lodash.isarray":115}],151:[function(t,e){var n=t("lodash._baseflatten"),r=t("lodash._baseuniq"),i=t("lodash.restparam"),o=i(function(t){return r(n(t,!1,!0))});e.exports=o},{"lodash._baseflatten":152,"lodash._baseuniq":154,"lodash.restparam":159}],152:[function(t,e,n){arguments[4][138][0].apply(n,arguments)},{dup:138,"lodash.isarguments":153,"lodash.isarray":115}],153:[function(t,e,n){arguments[4][42][0].apply(n,arguments)},{dup:42}],154:[function(t,e){function n(t,e){var n=-1,s=r,a=t.length,u=!0,c=u&&a>=200,l=c?o():null,h=[];l?(s=i,u=!1):(c=!1,l=e?[]:h);t:for(;++n<a;){var f=t[n],p=e?e(f,n,t):f;if(u&&f===f){for(var d=l.length;d--;)if(l[d]===p)continue t;e&&l.push(p),h.push(f)}else s(l,p,0)<0&&((e||c)&&l.push(p),h.push(f))}return h}var r=t("lodash._baseindexof"),i=t("lodash._cacheindexof"),o=t("lodash._createcache");e.exports=n},{"lodash._baseindexof":155,"lodash._cacheindexof":156,"lodash._createcache":157}],155:[function(t,e,n){arguments[4][112][0].apply(n,arguments)},{dup:112}],156:[function(t,e,n){arguments[4][135][0].apply(n,arguments)},{dup:135}],157:[function(t,e,n){arguments[4][136][0].apply(n,arguments)},{dup:136,"lodash.isnative":158}],158:[function(t,e,n){arguments[4][47][0].apply(n,arguments)},{dup:47}],159:[function(t,e,n){arguments[4][58][0].apply(n,arguments)},{dup:58}],160:[function(t,e,n){arguments[4][50][0].apply(n,arguments)},{dup:50,"lodash._basetostring":161}],161:[function(t,e,n){arguments[4][51][0].apply(n,arguments)},{dup:51}],162:[function(t,e,n){function r(t){for(var e=t.context.createBuffer(t.numberOfChannels,t.length,t.sampleRate),n=0,r=t.numberOfChannels;r>n;++n){var i=e.getChannelData(n),o=t.getChannelData(n);i.set(o,0)}return e}function i(t){for(var e=0,n=t.numberOfChannels;n>e;++e){var r=t.getChannelData(e);Array.prototype.reverse.call(r)}}function o(t){for(var e=0,n=t.numberOfChannels;n>e;++e)for(var r=t.getChannelData(e),i=t.length;i--;)r[i]=-r[i]}function s(t){for(var e=0,n=t.numberOfChannels;n>e;++e)for(var r=t.getChannelData(e),i=t.length;i--;)r[i]=0}function a(t){for(var e=0,n=t.numberOfChannels;n>e;++e)for(var r=t.getChannelData(e),i=t.length;i--;)r[i]=2*Math.random()-1}n.clone=r,n.reverse=i,n.invert=o,n.zero=s,n.noise=a},{}],163:[function(t,e){var n=t("global/window"),r=n.AudioContext||n.webkitAudioContext;r&&(e.exports=new r)},{"global/window":164}],164:[function(t,e){(function(t){e.exports="undefined"!=typeof window?window:"undefined"!=typeof t?t:{}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],165:[function(t,e,n){!function(t){"object"==typeof n?e.exports=t():"function"==typeof define&&define.amd?define(t):window.AudioNotes=t()}(function(){function t(t){return 440*Math.pow(2,(t-57)/12)}for(var e={},n="CcDdEFfGgAaB",r=0;10>=r;++r)for(var i=0;12>i;++i)e[12*r+i]=e[n[i]+r]=t(12*r+i);return e})},{}],166:[function(t,e){function n(){return[].slice.call(arguments).join("//")}function r(){return[].slice.call(arguments).map(function(t){return"object"==typeof t?JSON.stringify(t):t}).join("//")}function i(t,e,n,r){var i=1;if(/^\d+$/.test(t))return void(e[t]={});var o=t.match(p)||0;o&&(o=o&&parseInt(o[1],10),i=o+1,t=t.replace(p,""));var s=t.match(d)||0;s&&(s=s&&parseInt(s[1],10),n=s-1,t=t.replace(d,""));var a=h(i,n);if(t&&"*"!==t){if("odd"===t||"even"===t){var u="even"===t?0:1;f(a,2,u).forEach(function(t){e[t]={}})}else if("string"==typeof t&&~t.indexOf("%")){var c=t.split("%"),g=c[0]&&parseInt(c[0],10)||1,v=parseInt(c[1],10);l(o,n,g,v).forEach(function(t){e[t]={}})}else if("function"==typeof r){var m=r(t,i,n);Array.isArray(m)&&m.forEach(function(t){e[t]={}})}}else a.forEach(function(t){e[t]={}})}function o(t){var e=[];return Object.keys(t).forEach(function(n){Object.keys(t[n]).forEach(function(r){Object.keys(t[n][r]).forEach(function(t){t=10>t?"0"+t:t,e.push([n,r,t].join("."))})})}),e}function s(t,e){if(!t)throw new Error('Invalid "notes" array');if(!e||"object"!=typeof e)throw new Error('Invalid "options" object');if("number"!=typeof e.beatsPerBar||e.beatsPerBar<0)throw new Error("Invalid options: beatsPerBar is not a valid number");if("number"!=typeof e.barsPerLoop||e.barsPerLoop<0)throw new Error("Invalid options: barsPerLoop is not a valid number");var n=[];return t.forEach(function(t){var r=t[0];return u(r)?n.push(t):void g(r,e.barsPerLoop,e.beatsPerBar,e.expander).forEach(function(e){var r=t.slice();r[0]=e,n.push(r)})}),n}var a=t("lodash.memoize"),u=a(function(t){return!!t.match(/^\d+\.\d+\.\d+$/)}),c=a(function(t){return t.split(".").map(function(t){var e=parseInt(t,10);return t.match(/^\d+$/)&&!isNaN(e)?e:t})}),l=a(function(t,e,n,r){for(var i=[];e>=n;)n>t&&i.push(n),n+=r;return i},r),h=a(function(t,e){for(var n=[],r=t;e>=r;)n.push(r),r++;return n},n),f=a(function(t,e,n){return t.filter(function(t){return t%e===n})},n),p=/>(\d+)/,d=/<(\d+)/,g=a(function(t,e,n,r){var s=c(t),a={};return i(s[0],a,e,r),Object.keys(a).forEach(function(t){i(s[1],a[t],n,r),Object.keys(a[t]).forEach(function(e){i(s[2],a[t][e],96,r)})}),o(a)},n);e.exports=s},{"lodash.memoize":176}],167:[function(t,e){function n(t,e){if(!(this instanceof n))return new n(t,e);if(!t||"object"!=typeof t||"function"!=typeof t.createScriptProcessor)throw new Error("Invalid arguments: cannot init without AudioContext");r.EventEmitter.call(this),e=e||{},this.context=t,this.clock=o(this.context),this.scheduler=s(),this.expressions=a,this.expandNote=e.expandNote,this.upstartWait=e.upstartWait||250,this.setTempo(e.tempo||120),this.setBeatsPerBar(e.beatsPerBar||4),this.setLoopLength(e.loopLength||2),this._position="0.0.00",this.clock.on("data",this.updatePositionFromClock.bind(this)),this.clock.pipe(this.scheduler).on("data",this.emitStep.bind(this)),this._keepAlive=this._keepAlive.bind(this)}var r=t("events"),i=t("util").inherits,o=t("bopper"),s=t("./vendor/ditty"),a=t("dilla-expressions"),u=t("./lib/checkValid"),c=t("./lib/positionHelper"),l=(new Date).valueOf();i(n,r.EventEmitter);var h=n.prototype;h.updatePositionFromClock=function(t){var e=this.getPositionFromTime(t.time);this._position!==e&&(this._position=e,this.emit("tick",{position:this._position,context:this.context}))},h.getPositionFromTime=function(t){var e=this.clock._state.cycleLength*this.clock._state.preCycle*1,n=this.clock.getPositionAt(t-e);return this.getPositionFromClockPosition(n)},h.getPositionFromClockPosition=function(t){if(u.number("clockPosition",t),0>t)return"0.0.00";var e=this._loopLength*this._beatsPerBar,n=Math.floor(t/e)||0;t-=n*e;var r=Math.floor(t/this._beatsPerBar);t-=r*this._beatsPerBar;var i=Math.floor(t);t-=i;var o=Math.floor(96*t)+1;return 10>o&&(o="0"+o),r+1+"."+(i+1)+"."+o},h.getClockPositionFromPosition=function(t){var e=t.split("."),n=parseInt(e[0],10)-1,r=parseInt(e[1],10)-1,i=parseInt(e[2],10)-1;return n*this._beatsPerBar+r+i/96},h.getPositionWithOffset=function(t,e){if(!u.positionString(t))throw new Error("Invalid argument: position is not a valid position string");if("number"!=typeof e||isNaN(e)||e%1!==0)throw new Error("Invalid argument: offset is not a valid number");if(!e)return t;var n=this.getClockPositionFromPosition(t),r=e/96;return this.getPositionFromClockPosition(n+r)},h.getDurationFromTicks=function(t){return u.positiveNumber("ticks",t),1/96*t},h.emitStep=function(t){var e=t.offset=this.clock._state.cycleLength*this.clock._state.preCycle*1,n=t.args=t.args[0];t.time=t.time+e,t.clockPosition=t.position,t.position="start"===t.event?n.position:this.getPositionWithOffset(n.position,n.duration||0),("stop"!==t.event||t.position!==n.position)&&(t.context=this.context,this.emit("step",t))},h.set=function(t,e){var n=this;if("string"!=typeof t)throw new Error("Invalid argument: id is not a valid string");if(!e||!Array.isArray(e))throw new Error("Invalid argument: notes is not a valid array");e=this.expressions(e.map(function(t){return!Array.isArray(t)&&"object"==typeof t&&t.position?[t.position,t]:t}),{beatsPerBar:this.beatsPerBar(),barsPerLoop:this.loopLength()}).filter(function(t){return c.isPositionWithinBounds(t[0],n.loopLength(),n.beatsPerBar())}).map(function(t){n.expandNote&&(t=n.expandNote(t));var e=c.normalizeNote(t);return[n.getClockPositionFromPosition(e.position),n.getDurationFromTicks(e.duration||0),null,null,e]}),this.scheduler.set(t,e,this.beatsPerBar()*this.loopLength())},h.get=function(t){if("string"!=typeof t)throw new Error("Invalid argument: id is not a valid string");return(this.scheduler.get(t)||[]).map(function(t){return t[4]})},h.channels=function(){return this.scheduler.getIds()},h.clear=function(t){var e=this;if(t){if("string"!=typeof t)throw new Error("Invalid argument: id is not a valid string");this.set(t,[])}else this.scheduler.getIds().forEach(function(t){e.clear(t)})},h._keepAlive=function(){this.clock._state.playing&&(window.__lastDillaPosition=this._position,window.requestAnimationFrame(this._keepAlive))},h.start=function t(){var e=(new Date).valueOf(),n=e-l;return n<this.upstartWait?setTimeout(t.bind(this),this.upstartWait-n):void(this.clock._state.playing||(this.clock.start(),this._keepAlive(),this.emit("playing")))},h.pause=function(){this.clock._state.playing&&(this.clock.stop(),this.emit("paused"))},h.stop=function(){this.clock._state.playing&&(this.clock.stop(),this.emit("paused"),this.clock.setPosition(0),this._position="0.0.00")},h.position=function(){return this._position},h.setPosition=function(t){if(!c.isPositionWithinBounds(t,this.loopLength(),this.beatsPerBar()))throw new Error("Invalid argument: position is not valid");this._position=t,this.clock.setPosition(this.getClockPositionFromPosition(t))},h.tempo=function(){return this.clock.getTempo()},h.setTempo=function(t){if("number"!=typeof t||0>t||isNaN(t))throw new Error("Invalid argument: tempo is not a valid number");this.clock.setTempo(t)},h.beatsPerBar=function(){return this._beatsPerBar},h.setBeatsPerBar=function(t){u.positiveNumber("beats",t),this._beatsPerBar=t},h.loopLength=function(){return this._loopLength},h.setLoopLength=function(t){u.positiveNumber("bars",t),this._loopLength=t},e.exports=n},{"./lib/checkValid":168,"./lib/positionHelper":169,"./vendor/ditty":173,bopper:170,"dilla-expressions":166,events:203,util:221}],168:[function(t,e){var n={number:function(t,e){if("number"!=typeof e||isNaN(e))throw new Error("Invalid argument: "+t+" is not a valid number")},positiveNumber:function(t,e){if(n.number(t,e),0>e)throw new Error("Invalid argument: "+t+" is not a valid positive number")},positionString:function(t){return"string"==typeof t&&!!t.match(/\d\.\d\.\d+/)}};e.exports=n},{}],169:[function(t,e){var n=t("./checkValid"),r={normalizeNote:function(t){if(!t||!Array.isArray(t))throw new Error("Invalid argument: note params is not valid array");

var e="object"==typeof t[1]?t[1]:"object"==typeof t[0]?t[0]:{},r="string"==typeof t[0]&&n.positionString(t[0])?t[0]:"string"==typeof e.position&&n.positionString(e.position)?e.position:null;if(!r)throw new Error("Invalid argument: position is not valid");return e.position=r,e},isPositionWithinBounds:function(t,e,r){if(!n.positionString(t))return!1;var i=t.split("."),o=parseInt(i[0],10)-1,s=parseInt(i[1],10)-1,a=parseInt(i[2],10)-1;return 0>a||0>s||0>o||a>=96||s>=r||o>=e?!1:!0}};e.exports=r},{"./checkValid":168}],170:[function(t,e){function n(t){if(!(this instanceof n))return new n(t);var e=this;i.call(this),this.readable=!0,this.writable=!1,this.context=t;var s=this._processor=t.createScriptProcessor(512,1,1),a=r.bind(this);this._processor.onaudioprocess=a;var u=120,c=1/t.sampleRate*this._processor.bufferSize;this._state={lastTo:0,lastEndTime:0,playing:!1,bpm:u,beatDuration:60/u,increment:u/60*c,cycleLength:c,preCycle:5},this.onSchedule=o(function(t){e.on("data",t)}),s.connect(t.destination)}function r(){var t=this._state,e=this.context.currentTime,n=this.context.currentTime+t.cycleLength*t.preCycle,r=t.lastEndTime;if(t.lastEndTime=n,t.playing){var i=n-r,o=i/t.beatDuration,s=t.lastTo,a=s+o;t.lastTo=a,e-2*t.cycleLength<r&&this._schedule(r,s,a)}}var i=t("stream"),o=t("geval"),s=t("util").inherits;e.exports=n,s(n,i);var a=n.prototype;a.start=function(){this._state.playing=!0,this.emit("start")},a.stop=function(){this._state.playing=!1,this.emit("stop")},a.setTempo=function(t){var e=t/60,n=this._state;n.beatDuration=60/t,n.increment=e*n.cycleLength,n.bpm=t,this.emit("tempo",n.bpm)},a.getTempo=function(){return this._state.bpm},a.isPlaying=function(){return this._state.playing},a.setPosition=function(t){this._state.lastTo=parseFloat(t)},a.setSpeed=function(t){var e=this._state;t=parseFloat(t)||0;var n=e.bpm*t,r=n/60;e.beatDuration=60/n,e.increment=r*e.cycleLength},a.getPositionAt=function(t){var e=this._state,n=e.lastEndTime-t;return e.lastTo-n/e.beatDuration},a.getTimeAt=function(t){var e=this._state,n=this.getCurrentPosition()-t;return this.context.currentTime-n*e.beatDuration},a.getCurrentPosition=function(){return this.getPositionAt(this.context.currentTime)},a.getNextScheduleTime=function(){var t=this._state;return t.lastEndTime},a.getBeatDuration=function(){var t=this._state;return t.beatDuration},a._schedule=function(t,e,n){var r=this._state,i=(n-e)*r.beatDuration;this.emit("data",{from:e,to:n,time:t,duration:i,beatDuration:r.beatDuration})}},{geval:172,stream:218,util:221}],171:[function(t,e){function n(){function t(t){for(var e=0;e<n.length;e++)n[e](t)}function e(t){function e(){var e=n.indexOf(t);-1!==e&&n.splice(e,1)}return n.push(t),e}var n=[];return{broadcast:t,listen:e}}e.exports=n},{}],172:[function(t,e){function n(t){var e=r();return t(e.broadcast),e.listen}var r=t("./event.js");e.exports=n},{"./event.js":171}],173:[function(t,e){function n(){return this instanceof n?(s.call(this),this.readable=!0,this.writable=!0,void(this._state={loops:{},lengths:{},ids:[],queue:[]})):new n}function r(t,e){return t.time-e.time}function i(t,e,n){t%=n;var r=e%n,i=e+t-r;return e>i?i+n:i}function o(t,e){return!("stop"!==t.event||e&&e.length)}e.exports=n;var s=t("stream"),a=t("util").inherits;a(n,s);var u=n.prototype;u.set=function(t,e,n){var r=this._state;if(e)r.loops[t]||r.ids.push(t),r.loops[t]=e,r.lengths[t]=n||8;else{var i=r.ids.indexOf(t);~i&&r.ids.splice(i,1),r.loops[t]=null}r.loops[t]?this.emit("change",{id:t,events:r.loops[t],length:r.lengths[t]}):this.emit("change",{id:t})},u.get=function(t){return this._state.loops[t]},u.getLength=function(t){return this._state.lengths[t]},u.getIds=function(){return this._state.ids},u.getDescriptors=function(){for(var t=this._state,e=[],n=0;n<t.ids.length;n++){var r=t.ids[n];t.loops[r]&&e.push({id:r,length:t.lengths[r],events:t.loops[r]})}return e},u.update=function(t){this.set(t.id,t.events,t.length)},u.push=function(t){this.emit("data",t)},u.write=function(t){this._transform(t)},u._transform=function(t){for(var e=window.performance.now(),n=e+1e4*t.duration,s=this._state,a=t.from,u=t.to,c=t.time,l=t.time+t.duration,h=t.beatDuration,f=s.ids,p=s.queue,d=[],g=p.length-1;g>=0;g--){var v=p[g];if(u>v.position||o(v,s.loops[v.id])){if(u>v.position){var m=(v.position-a)*h;v.time=c+m}else v.time=c,v.position=a;p.splice(g,1),this.push(v)}}for(var g=0;g<f.length;g++)for(var y=f[g],b=s.loops[y],_=s.lengths[y],w=0;w<b.length;w++){var x=b[w],E=i(x[0],a,_),k=E+x[1];if(E>=a&&u>E){var m=(E-a)*h,j=x[1]*h,P=c+m,S=P+j;d.push({id:y,event:"start",position:E,args:x.slice(4),time:P}),d.push({id:y,event:"stop",position:k,args:x.slice(4),time:S})}}d.sort(r);for(var g=0;g<d.length;g++){var v=d[g];v.time<l?window.performance.now()<n&&this.push(v):(p.push(v),log("dropped",v.args[0]))}}},{stream:218,util:221}],174:[function(t,e){function n(t,e,n){function i(){v&&clearTimeout(v),f&&clearTimeout(f),f=v=m=void 0}function a(){var n=e-(u()-d);if(0>=n||n>e){f&&clearTimeout(f);var r=m;f=v=m=void 0,r&&(y=u(),p=t.apply(g,h),v||f||(h=g=null))}else v=setTimeout(a,n)}function c(){v&&clearTimeout(v),f=v=m=void 0,(_||b!==e)&&(y=u(),p=t.apply(g,h),v||f||(h=g=null))}function l(){if(h=arguments,d=u(),g=this,m=_&&(v||!w),b===!1)var n=w&&!v;else{f||w||(y=d);var r=b-(d-y),i=0>=r||r>b;i?(f&&(f=clearTimeout(f)),y=d,p=t.apply(g,h)):f||(f=setTimeout(c,r))}return i&&v?v=clearTimeout(v):v||e===b||(v=setTimeout(a,e)),n&&(i=!0,p=t.apply(g,h)),!i||v||f||(h=g=null),p}var h,f,p,d,g,v,m,y=0,b=!1,_=!0;if("function"!=typeof t)throw new TypeError(o);if(e=0>e?0:+e||0,n===!0){var w=!0;_=!1}else r(n)&&(w=n.leading,b="maxWait"in n&&s(+n.maxWait||0,e),_="trailing"in n?n.trailing:_);return l.cancel=i,l}function r(t){var e=typeof t;return"function"==e||!!t&&"object"==e}var i=t("lodash.isnative"),o="Expected a function",s=Math.max,a=i(a=Date.now)&&a,u=a||function(){return(new Date).getTime()};e.exports=n},{"lodash.isnative":175}],175:[function(t,e,n){arguments[4][47][0].apply(n,arguments)},{dup:47}],176:[function(t,e){function n(){this.__data__={}}function r(t){return this.has(t)&&delete this.__data__[t]}function i(t){return"__proto__"==t?void 0:this.__data__[t]}function o(t){return"__proto__"!=t&&l.call(this.__data__,t)}function s(t,e){return"__proto__"!=t&&(this.__data__[t]=e),this}function a(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new TypeError(u);var n=function(){var r=arguments,i=n.cache,o=e?e.apply(this,r):r[0];if(i.has(o))return i.get(o);var s=t.apply(this,r);return i.set(o,s),s};return n.cache=new a.Cache,n}var u="Expected a function",c=Object.prototype,l=c.hasOwnProperty;n.prototype.delete=r,n.prototype.get=i,n.prototype.has=o,n.prototype.set=s,a.Cache=n,e.exports=a},{}],177:[function(t,e){function n(t){return!!t&&"object"==typeof t}function r(t,e,o,a,u){if(!c(t))return t;var l=s(e)&&(g(e)||y(e));if(!l){var h=b(e);E.apply(h,P(e))}return f(h||e,function(s,c){if(h&&(c=s,s=e[c]),n(s))a||(a=[]),u||(u=[]),i(t,e,c,r,o,a,u);else{var f=t[c],p=o?o(f,s,c,t,e):void 0,d=void 0===p;d&&(p=s),!l&&void 0===p||!d&&(p===p?p===f:f!==f)||(t[c]=p)}}),t}function i(t,e,n,r,i,o,a){for(var u=o.length,c=e[n];u--;)if(o[u]==c)return void(t[n]=a[u]);var l=t[n],f=i?i(l,c,n,t,e):void 0,p=void 0===f;p&&(f=c,s(c)&&(g(c)||y(c))?f=g(l)?l:s(l)?h(l):[]:m(c)||d(c)?f=d(l)?_(l):m(l)?l:{}:p=!1),o.push(c),a.push(f),p?t[n]=r(f,c,i,o,a):(f===f?f!==l:l===l)&&(t[n]=f)}function o(t){return function(e){return null==e?void 0:e[t]}}function s(t){return null!=t&&a(j(t))}function a(t){return"number"==typeof t&&t>-1&&t%1==0&&k>=t}function u(t){return c(t)?t:Object(t)}function c(t){var e=typeof t;return"function"==e||!!t&&"object"==e}function l(t){return function(){return t}}var h=t("lodash._arraycopy"),f=t("lodash._arrayeach"),p=t("lodash._createassigner"),d=t("lodash.isarguments"),g=t("lodash.isarray"),v=t("lodash.isnative"),m=t("lodash.isplainobject"),y=t("lodash.istypedarray"),b=t("lodash.keys"),_=(t("lodash.keysin"),t("lodash.toplainobject")),w=Array.prototype,x=v(x=Object.getOwnPropertySymbols)&&x,E=w.push,k=Math.pow(2,53)-1,j=o("length"),P=x?function(t){return x(u(t))}:l([]),S=p(r);e.exports=S},{"lodash._arraycopy":178,"lodash._arrayeach":179,"lodash._createassigner":180,"lodash.isarguments":184,"lodash.isarray":185,"lodash.isnative":186,"lodash.isplainobject":187,"lodash.istypedarray":189,"lodash.keys":190,"lodash.keysin":191,"lodash.toplainobject":192}],178:[function(t,e,n){arguments[4][64][0].apply(n,arguments)},{dup:64}],179:[function(t,e,n){arguments[4][38][0].apply(n,arguments)},{dup:38}],180:[function(t,e,n){arguments[4][55][0].apply(n,arguments)},{dup:55,"lodash._bindcallback":181,"lodash._isiterateecall":182,"lodash.restparam":183}],181:[function(t,e,n){arguments[4][40][0].apply(n,arguments)},{dup:40}],182:[function(t,e,n){arguments[4][57][0].apply(n,arguments)},{dup:57}],183:[function(t,e,n){arguments[4][58][0].apply(n,arguments)},{dup:58}],184:[function(t,e,n){arguments[4][42][0].apply(n,arguments)},{dup:42}],185:[function(t,e,n){arguments[4][68][0].apply(n,arguments)},{dup:68}],186:[function(t,e,n){arguments[4][47][0].apply(n,arguments)},{dup:47}],187:[function(t,e){function n(t){return!!t&&"object"==typeof t}function r(t,e){return o(t,e,a)}function i(t){var e;if(!n(t)||h.call(t)!=u||!l.call(t,"constructor")&&(e=t.constructor,"function"==typeof e&&!(e instanceof e)))return!1;var i;return r(t,function(t,e){i=e}),void 0===i||l.call(t,i)}var o=t("lodash._basefor"),s=t("lodash.isnative"),a=t("lodash.keysin"),u="[object Object]",c=Object.prototype,l=c.hasOwnProperty,h=c.toString,f=s(f=Object.getPrototypeOf)&&f,p=f?function(t){if(!t||h.call(t)!=u)return!1;var e=t.valueOf,n=s(e)&&(n=f(e))&&f(n);return n?t==n||f(t)==n:i(t)}:i;e.exports=p},{"lodash._basefor":188,"lodash.isnative":186,"lodash.keysin":191}],188:[function(t,e,n){arguments[4][95][0].apply(n,arguments)},{dup:95}],189:[function(t,e,n){arguments[4][121][0].apply(n,arguments)},{dup:121}],190:[function(t,e,n){arguments[4][45][0].apply(n,arguments)},{dup:45,"lodash.isarguments":184,"lodash.isarray":185,"lodash.isnative":186}],191:[function(t,e,n){arguments[4][144][0].apply(n,arguments)},{dup:144,"lodash.isarguments":184,"lodash.isarray":185}],192:[function(t,e){function n(t){return r(t,i(t))}var r=t("lodash._basecopy"),i=t("lodash.keysin");e.exports=n},{"lodash._basecopy":193,"lodash.keysin":191}],193:[function(t,e,n){arguments[4][54][0].apply(n,arguments)},{dup:54}],194:[function(t,e){function n(t){return function(e,n,o){return e=r(e),(t?e:"")+i(e,n,o)+(t?"":e)}}var r=t("lodash._basetostring"),i=t("lodash._createpadding"),o=n();e.exports=o},{"lodash._basetostring":195,"lodash._createpadding":196}],195:[function(t,e,n){arguments[4][51][0].apply(n,arguments)},{dup:51}],196:[function(t,e){(function(n){function r(t,e,n){var r=t.length;if(e=+e,r>=e||!s(e))return"";var a=e-r;return n=null==n?" ":n+"",i(n,o(a/n.length)).slice(0,a)}var i=t("lodash.repeat"),o=Math.ceil,s=n.isFinite;e.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"lodash.repeat":197}],197:[function(t,e){(function(n){function r(t,e){var n="";if(t=i(t),e=+e,1>e||!t||!s(e))return n;do e%2&&(n+=t),e=o(e/2),t+=t;while(e);return n}var i=t("lodash._basetostring"),o=Math.floor,s=n.isFinite;e.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"lodash._basetostring":195}],198:[function(){},{}],199:[function(t,e,n){function r(t,e){var n=this;if(!(n instanceof r))return new r(t,e);var i,o=typeof t;if("number"===o)i=+t;else if("string"===o)i=r.byteLength(t,e);else{if("object"!==o||null===t)throw new TypeError("must start with number, buffer, array or string");"Buffer"===t.type&&C(t.data)&&(t=t.data),i=+t.length}if(i>N)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+N.toString(16)+" bytes");0>i?i=0:i>>>=0,r.TYPED_ARRAY_SUPPORT?n=r._augment(new Uint8Array(i)):(n.length=i,n._isBuffer=!0);var s;if(r.TYPED_ARRAY_SUPPORT&&"number"==typeof t.byteLength)n._set(t);else if(P(t))if(r.isBuffer(t))for(s=0;i>s;s++)n[s]=t.readUInt8(s);else for(s=0;i>s;s++)n[s]=(t[s]%256+256)%256;else if("string"===o)n.write(t,0,e);else if("number"===o&&!r.TYPED_ARRAY_SUPPORT)for(s=0;i>s;s++)n[s]=0;return i>0&&i<=r.poolSize&&(n.parent=q),n}function i(t,e){if(!(this instanceof i))return new i(t,e);var n=new r(t,e);return delete n.parent,n}function o(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r),r>i&&(r=i)):r=i;var o=e.length;if(o%2!==0)throw new Error("Invalid hex string");r>o/2&&(r=o/2);for(var s=0;r>s;s++){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))throw new Error("Invalid hex string");t[n+s]=a}return s}function s(t,e,n,r){var i=L(A(e,t.length-n),t,n,r);return i}function a(t,e,n,r){var i=L(T(e),t,n,r);return i}function u(t,e,n,r){return a(t,e,n,r)}function c(t,e,n,r){var i=L(I(e),t,n,r);return i}function l(t,e,n,r){var i=L(O(e,t.length-n),t,n,r);return i}function h(t,e,n){return M.fromByteArray(0===e&&n===t.length?t:t.slice(e,n))}function f(t,e,n){var r="",i="";n=Math.min(t.length,n);for(var o=e;n>o;o++)t[o]<=127?(r+=R(i)+String.fromCharCode(t[o]),i=""):i+="%"+t[o].toString(16);return r+R(i)}function p(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;n>i;i++)r+=String.fromCharCode(127&t[i]);return r}function d(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;n>i;i++)r+=String.fromCharCode(t[i]);return r}function g(t,e,n){var r=t.length;(!e||0>e)&&(e=0),(!n||0>n||n>r)&&(n=r);for(var i="",o=e;n>o;o++)i+=S(t[o]);return i}function v(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function m(t,e,n){if(t%1!==0||0>t)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function y(t,e,n,i,o,s){if(!r.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");if(e>o||s>e)throw new RangeError("value is out of bounds");if(n+i>t.length)throw new RangeError("index out of range")}function b(t,e,n,r){0>e&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-n,2);o>i;i++)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function _(t,e,n,r){0>e&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-n,4);o>i;i++)t[n+i]=e>>>8*(r?i:3-i)&255}function w(t,e,n,r,i,o){if(e>i||o>e)throw new RangeError("value is out of bounds");if(n+r>t.length)throw new RangeError("index out of range");if(0>n)throw new RangeError("index out of range")}function x(t,e,n,r,i){return i||w(t,e,n,4,3.4028234663852886e38,-3.4028234663852886e38),B.write(t,e,n,r,23,4),n+4}function E(t,e,n,r,i){return i||w(t,e,n,8,1.7976931348623157e308,-1.7976931348623157e308),B.write(t,e,n,r,52,8),n+8}function k(t){if(t=j(t).replace(U,""),t.length<2)return"";for(;t.length%4!==0;)t+="=";return t}function j(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function P(t){return C(t)||r.isBuffer(t)||t&&"object"==typeof t&&"number"==typeof t.length}function S(t){return 16>t?"0"+t.toString(16):t.toString(16)}function A(t,e){e=e||1/0;for(var n,r=t.length,i=null,o=[],s=0;r>s;s++){if(n=t.charCodeAt(s),n>55295&&57344>n){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(56320>n){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=i-55296<<10|n-56320|65536,i=null}else i&&((e-=3)>-1&&o.push(239,191,189),i=null);if(128>n){if((e-=1)<0)break;o.push(n)}else if(2048>n){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(65536>n){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(2097152>n))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function T(t){for(var e=[],n=0;n<t.length;n++)e.push(255&t.charCodeAt(n));return e}function O(t,e){for(var n,r,i,o=[],s=0;s<t.length&&!((e-=2)<0);s++)n=t.charCodeAt(s),r=n>>8,i=n%256,o.push(i),o.push(r);return o}function I(t){return M.toByteArray(k(t))}function L(t,e,n,r){for(var i=0;r>i&&!(i+n>=e.length||i>=t.length);i++)e[i+n]=t[i];return i}function R(t){try{return decodeURIComponent(t)}catch(t){return String.fromCharCode(65533)}}var M=t("base64-js"),B=t("ieee754"),C=t("is-array");n.Buffer=r,n.SlowBuffer=i,n.INSPECT_MAX_BYTES=50,r.poolSize=8192;var N=1073741823,q={};r.TYPED_ARRAY_SUPPORT=function(){try{var t=new ArrayBuffer(0),e=new Uint8Array(t);return e.foo=function(){return 42},42===e.foo()&&"function"==typeof e.subarray&&0===new Uint8Array(1).subarray(1,1).byteLength}catch(t){return!1}}(),r.isBuffer=function(t){return!(null==t||!t._isBuffer)},r.compare=function(t,e){if(!r.isBuffer(t)||!r.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,i=e.length,o=0,s=Math.min(n,i);s>o&&t[o]===e[o];o++);return o!==s&&(n=t[o],i=e[o]),i>n?-1:n>i?1:0},r.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},r.concat=function(t,e){if(!C(t))throw new TypeError("list argument must be an Array of Buffers.");if(0===t.length)return new r(0);if(1===t.length)return t[0];var n;if(void 0===e)for(e=0,n=0;n<t.length;n++)e+=t[n].length;var i=new r(e),o=0;for(n=0;n<t.length;n++){var s=t[n];s.copy(i,o),o+=s.length}return i},r.byteLength=function(t,e){var n;switch(t+="",e||"utf8"){case"ascii":case"binary":case"raw":n=t.length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":n=2*t.length;break;case"hex":n=t.length>>>1;break;case"utf8":case"utf-8":n=A(t).length;break;case"base64":n=I(t).length;break;default:n=t.length}return n},r.prototype.length=void 0,r.prototype.parent=void 0,r.prototype.toString=function(t,e,n){var r=!1;if(e>>>=0,n=void 0===n||n===1/0?this.length:n>>>0,t||(t="utf8"),0>e&&(e=0),n>this.length&&(n=this.length),e>=n)return"";for(;;)switch(t){case"hex":return g(this,e,n);case"utf8":case"utf-8":return f(this,e,n);case"ascii":return p(this,e,n);case"binary":return d(this,e,n);case"base64":return h(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return v(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}},r.prototype.equals=function(t){if(!r.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?!0:0===r.compare(this,t)},r.prototype.inspect=function(){var t="",e=n.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},r.prototype.compare=function(t){if(!r.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?0:r.compare(this,t)},r.prototype.indexOf=function(t,e){function n(t,e,n){for(var r=-1,i=0;n+i<t.length;i++)if(t[n+i]===e[-1===r?0:i-r]){if(-1===r&&(r=i),i-r+1===e.length)return n+r}else r=-1;return-1}if(e>2147483647?e=2147483647:-2147483648>e&&(e=-2147483648),e>>=0,0===this.length)return-1;if(e>=this.length)return-1;if(0>e&&(e=Math.max(this.length+e,0)),"string"==typeof t)return 0===t.length?-1:String.prototype.indexOf.call(this,t,e);if(r.isBuffer(t))return n(this,t,e);if("number"==typeof t)return r.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,t,e):n(this,[t],e);throw new TypeError("val must be string, number or Buffer")},r.prototype.get=function(t){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(t)},r.prototype.set=function(t,e){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(t,e)},r.prototype.write=function(t,e,n,r){if(isFinite(e))isFinite(n)||(r=n,n=void 0);else{var i=r;r=e,e=n,n=i}if(e=Number(e)||0,0>n||0>e||e>this.length)throw new RangeError("attempt to write outside buffer bounds");var h=this.length-e;n?(n=Number(n),n>h&&(n=h)):n=h,r=String(r||"utf8").toLowerCase();var f;switch(r){case"hex":f=o(this,t,e,n);break;case"utf8":case"utf-8":f=s(this,t,e,n);break;case"ascii":f=a(this,t,e,n);break;case"binary":f=u(this,t,e,n);break;case"base64":f=c(this,t,e,n);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":f=l(this,t,e,n);break;default:throw new TypeError("Unknown encoding: "+r)}return f},r.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},r.prototype.slice=function(t,e){var n=this.length;t=~~t,e=void 0===e?n:~~e,0>t?(t+=n,0>t&&(t=0)):t>n&&(t=n),0>e?(e+=n,0>e&&(e=0)):e>n&&(e=n),t>e&&(e=t);var i;if(r.TYPED_ARRAY_SUPPORT)i=r._augment(this.subarray(t,e));else{var o=e-t;i=new r(o,void 0);for(var s=0;o>s;s++)i[s]=this[s+t]}return i.length&&(i.parent=this.parent||this),i},r.prototype.readUIntLE=function(t,e,n){t>>>=0,e>>>=0,n||m(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},r.prototype.readUIntBE=function(t,e,n){t>>>=0,e>>>=0,n||m(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},r.prototype.readUInt8=function(t,e){return e||m(t,1,this.length),this[t]},r.prototype.readUInt16LE=function(t,e){return e||m(t,2,this.length),this[t]|this[t+1]<<8},r.prototype.readUInt16BE=function(t,e){return e||m(t,2,this.length),this[t]<<8|this[t+1]},r.prototype.readUInt32LE=function(t,e){return e||m(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},r.prototype.readUInt32BE=function(t,e){return e||m(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},r.prototype.readIntLE=function(t,e,n){t>>>=0,e>>>=0,n||m(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*e)),r},r.prototype.readIntBE=function(t,e,n){t>>>=0,e>>>=0,n||m(t,e,this.length);for(var r=e,i=1,o=this[t+--r];r>0&&(i*=256);)o+=this[t+--r]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*e)),o},r.prototype.readInt8=function(t,e){return e||m(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},r.prototype.readInt16LE=function(t,e){e||m(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},r.prototype.readInt16BE=function(t,e){e||m(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},r.prototype.readInt32LE=function(t,e){return e||m(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},r.prototype.readInt32BE=function(t,e){return e||m(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},r.prototype.readFloatLE=function(t,e){return e||m(t,4,this.length),B.read(this,t,!0,23,4)},r.prototype.readFloatBE=function(t,e){return e||m(t,4,this.length),B.read(this,t,!1,23,4)},r.prototype.readDoubleLE=function(t,e){return e||m(t,8,this.length),B.read(this,t,!0,52,8)},r.prototype.readDoubleBE=function(t,e){return e||m(t,8,this.length),B.read(this,t,!1,52,8)},r.prototype.writeUIntLE=function(t,e,n,r){t=+t,e>>>=0,n>>>=0,r||y(this,t,e,n,Math.pow(2,8*n),0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i>>>0&255;return e+n},r.prototype.writeUIntBE=function(t,e,n,r){t=+t,e>>>=0,n>>>=0,r||y(this,t,e,n,Math.pow(2,8*n),0);var i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o>>>0&255;return e+n},r.prototype.writeUInt8=function(t,e,n){return t=+t,e>>>=0,n||y(this,t,e,1,255,0),r.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=t,e+1},r.prototype.writeUInt16LE=function(t,e,n){return t=+t,e>>>=0,n||y(this,t,e,2,65535,0),r.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8):b(this,t,e,!0),e+2},r.prototype.writeUInt16BE=function(t,e,n){return t=+t,e>>>=0,n||y(this,t,e,2,65535,0),r.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=t):b(this,t,e,!1),e+2},r.prototype.writeUInt32LE=function(t,e,n){return t=+t,e>>>=0,n||y(this,t,e,4,4294967295,0),r.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=t):_(this,t,e,!0),e+4},r.prototype.writeUInt32BE=function(t,e,n){return t=+t,e>>>=0,n||y(this,t,e,4,4294967295,0),r.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t):_(this,t,e,!1),e+4},r.prototype.writeIntLE=function(t,e,n,r){t=+t,e>>>=0,r||y(this,t,e,n,Math.pow(2,8*n-1)-1,-Math.pow(2,8*n-1));var i=0,o=1,s=0>t?1:0;for(this[e]=255&t;++i<n&&(o*=256);)this[e+i]=(t/o>>0)-s&255;return e+n},r.prototype.writeIntBE=function(t,e,n,r){t=+t,e>>>=0,r||y(this,t,e,n,Math.pow(2,8*n-1)-1,-Math.pow(2,8*n-1));var i=n-1,o=1,s=0>t?1:0;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=(t/o>>0)-s&255;return e+n},r.prototype.writeInt8=function(t,e,n){return t=+t,e>>>=0,n||y(this,t,e,1,127,-128),r.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),0>t&&(t=255+t+1),this[e]=t,e+1},r.prototype.writeInt16LE=function(t,e,n){return t=+t,e>>>=0,n||y(this,t,e,2,32767,-32768),r.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8):b(this,t,e,!0),e+2},r.prototype.writeInt16BE=function(t,e,n){return t=+t,e>>>=0,n||y(this,t,e,2,32767,-32768),r.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=t):b(this,t,e,!1),e+2},r.prototype.writeInt32LE=function(t,e,n){return t=+t,e>>>=0,n||y(this,t,e,4,2147483647,-2147483648),r.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):_(this,t,e,!0),e+4},r.prototype.writeInt32BE=function(t,e,n){return t=+t,e>>>=0,n||y(this,t,e,4,2147483647,-2147483648),0>t&&(t=4294967295+t+1),r.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t):_(this,t,e,!1),e+4},r.prototype.writeFloatLE=function(t,e,n){return x(this,t,e,!0,n)},r.prototype.writeFloatBE=function(t,e,n){return x(this,t,e,!1,n)},r.prototype.writeDoubleLE=function(t,e,n){return E(this,t,e,!0,n)},r.prototype.writeDoubleBE=function(t,e,n){return E(this,t,e,!1,n)},r.prototype.copy=function(t,e,n,i){if(n||(n=0),i||0===i||(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&n>i&&(i=n),i===n)return 0;if(0===t.length||0===this.length)return 0;if(0>e)throw new RangeError("targetStart out of bounds");if(0>n||n>=this.length)throw new RangeError("sourceStart out of bounds");if(0>i)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-n&&(i=t.length-e+n);var o=i-n;if(1e3>o||!r.TYPED_ARRAY_SUPPORT)for(var s=0;o>s;s++)t[s+e]=this[s+n];else t._set(this.subarray(n,n+o),e);return o},r.prototype.fill=function(t,e,n){if(t||(t=0),e||(e=0),n||(n=this.length),e>n)throw new RangeError("end < start");if(n!==e&&0!==this.length){if(0>e||e>=this.length)throw new RangeError("start out of bounds");if(0>n||n>this.length)throw new RangeError("end out of bounds");var r;if("number"==typeof t)for(r=e;n>r;r++)this[r]=t;else{var i=A(t.toString()),o=i.length;for(r=e;n>r;r++)this[r]=i[r%o]}return this}},r.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(r.TYPED_ARRAY_SUPPORT)return new r(this).buffer;for(var t=new Uint8Array(this.length),e=0,n=t.length;n>e;e+=1)t[e]=this[e];return t.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var D=r.prototype;r._augment=function(t){return t.constructor=r,t._isBuffer=!0,t._set=t.set,t.get=D.get,t.set=D.set,t.write=D.write,t.toString=D.toString,t.toLocaleString=D.toString,t.toJSON=D.toJSON,t.equals=D.equals,t.compare=D.compare,t.indexOf=D.indexOf,t.copy=D.copy,t.slice=D.slice,t.readUIntLE=D.readUIntLE,t.readUIntBE=D.readUIntBE,t.readUInt8=D.readUInt8,t.readUInt16LE=D.readUInt16LE,t.readUInt16BE=D.readUInt16BE,t.readUInt32LE=D.readUInt32LE,t.readUInt32BE=D.readUInt32BE,t.readIntLE=D.readIntLE,t.readIntBE=D.readIntBE,t.readInt8=D.readInt8,t.readInt16LE=D.readInt16LE,t.readInt16BE=D.readInt16BE,t.readInt32LE=D.readInt32LE,t.readInt32BE=D.readInt32BE,t.readFloatLE=D.readFloatLE,t.readFloatBE=D.readFloatBE,t.readDoubleLE=D.readDoubleLE,t.readDoubleBE=D.readDoubleBE,t.writeUInt8=D.writeUInt8,t.writeUIntLE=D.writeUIntLE,t.writeUIntBE=D.writeUIntBE,t.writeUInt16LE=D.writeUInt16LE,t.writeUInt16BE=D.writeUInt16BE,t.writeUInt32LE=D.writeUInt32LE,t.writeUInt32BE=D.writeUInt32BE,t.writeIntLE=D.writeIntLE,t.writeIntBE=D.writeIntBE,t.writeInt8=D.writeInt8,t.writeInt16LE=D.writeInt16LE,t.writeInt16BE=D.writeInt16BE,t.writeInt32LE=D.writeInt32LE,t.writeInt32BE=D.writeInt32BE,t.writeFloatLE=D.writeFloatLE,t.writeFloatBE=D.writeFloatBE,t.writeDoubleLE=D.writeDoubleLE,t.writeDoubleBE=D.writeDoubleBE,t.fill=D.fill,t.inspect=D.inspect,t.toArrayBuffer=D.toArrayBuffer,t};var U=/[^+\/0-9A-z\-]/g},{"base64-js":200,ieee754:201,"is-array":202}],200:[function(t,e,n){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(t){"use strict";function e(t){var e=t.charCodeAt(0);return e===s||e===h?62:e===a||e===f?63:u>e?-1:u+10>e?e-u+26+26:l+26>e?e-l:c+26>e?e-c+26:void 0}function n(t){function n(t){c[h++]=t}var r,i,s,a,u,c;if(t.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var l=t.length;u="="===t.charAt(l-2)?2:"="===t.charAt(l-1)?1:0,c=new o(3*t.length/4-u),s=u>0?t.length-4:t.length;var h=0;for(r=0,i=0;s>r;r+=4,i+=3)a=e(t.charAt(r))<<18|e(t.charAt(r+1))<<12|e(t.charAt(r+2))<<6|e(t.charAt(r+3)),n((16711680&a)>>16),n((65280&a)>>8),n(255&a);return 2===u?(a=e(t.charAt(r))<<2|e(t.charAt(r+1))>>4,n(255&a)):1===u&&(a=e(t.charAt(r))<<10|e(t.charAt(r+1))<<4|e(t.charAt(r+2))>>2,n(a>>8&255),n(255&a)),c}function i(t){function e(t){return r.charAt(t)}function n(t){return e(t>>18&63)+e(t>>12&63)+e(t>>6&63)+e(63&t)}var i,o,s,a=t.length%3,u="";for(i=0,s=t.length-a;s>i;i+=3)o=(t[i]<<16)+(t[i+1]<<8)+t[i+2],u+=n(o);switch(a){case 1:o=t[t.length-1],u+=e(o>>2),u+=e(o<<4&63),u+="==";break;case 2:o=(t[t.length-2]<<8)+t[t.length-1],u+=e(o>>10),u+=e(o>>4&63),u+=e(o<<2&63),u+="="}return u}var o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="+".charCodeAt(0),a="/".charCodeAt(0),u="0".charCodeAt(0),c="a".charCodeAt(0),l="A".charCodeAt(0),h="-".charCodeAt(0),f="_".charCodeAt(0);t.toByteArray=n,t.fromByteArray=i}("undefined"==typeof n?this.base64js={}:n)},{}],201:[function(t,e,n){n.read=function(t,e,n,r,i){var o,s,a=8*i-r-1,u=(1<<a)-1,c=u>>1,l=-7,h=n?i-1:0,f=n?-1:1,p=t[e+h];for(h+=f,o=p&(1<<-l)-1,p>>=-l,l+=a;l>0;o=256*o+t[e+h],h+=f,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=r;l>0;s=256*s+t[e+h],h+=f,l-=8);if(0===o)o=1-c;else{if(o===u)return s?0/0:(p?-1:1)*(1/0);s+=Math.pow(2,r),o-=c}return(p?-1:1)*s*Math.pow(2,o-r)},n.write=function(t,e,n,r,i,o){var s,a,u,c=8*o-i-1,l=(1<<c)-1,h=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,d=r?1:-1,g=0>e||0===e&&0>1/e?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=l):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),e+=s+h>=1?f/u:f*Math.pow(2,1-h),e*u>=2&&(s++,u/=2),s+h>=l?(a=0,s=l):s+h>=1?(a=(e*u-1)*Math.pow(2,i),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;t[n+p]=255&a,p+=d,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;t[n+p]=255&s,p+=d,s/=256,c-=8);t[n+p-d]|=128*g}},{}],202:[function(t,e){var n=Array.isArray,r=Object.prototype.toString;e.exports=n||function(t){return!!t&&"[object Array]"==r.call(t)}},{}],203:[function(t,e){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(t){return"function"==typeof t}function i(t){return"number"==typeof t}function o(t){return"object"==typeof t&&null!==t}function s(t){return void 0===t}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(t){if(!i(t)||0>t||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},n.prototype.emit=function(t){var e,n,i,a,u,c;if(this._events||(this._events={}),"error"===t&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[t],s(n))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(i=arguments.length,a=new Array(i-1),u=1;i>u;u++)a[u-1]=arguments[u];n.apply(this,a)}else if(o(n)){for(i=arguments.length,a=new Array(i-1),u=1;i>u;u++)a[u-1]=arguments[u];for(c=n.slice(),i=c.length,u=0;i>u;u++)c[u].apply(this,a)}return!0},n.prototype.addListener=function(t,e){var i;if(!r(e))throw TypeError("listener must be a function");if(this._events||(this._events={}),
this._events.newListener&&this.emit("newListener",t,r(e.listener)?e.listener:e),this._events[t]?o(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,o(this._events[t])&&!this._events[t].warned){var i;i=s(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[t].length>i&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace())}return this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(t,e){function n(){this.removeListener(t,n),i||(i=!0,e.apply(this,arguments))}if(!r(e))throw TypeError("listener must be a function");var i=!1;return n.listener=e,this.on(t,n),this},n.prototype.removeListener=function(t,e){var n,i,s,a;if(!r(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(n=this._events[t],s=n.length,i=-1,n===e||r(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(o(n)){for(a=s;a-->0;)if(n[a]===e||n[a].listener&&n[a].listener===e){i=a;break}if(0>i)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},n.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[t],r(n))this.removeListener(t,n);else for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},n.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?r(this._events[t])?[this._events[t]]:this._events[t].slice():[]},n.listenerCount=function(t,e){var n;return n=t._events&&t._events[e]?r(t._events[e])?1:t._events[e].length:0}},{}],204:[function(t,e){e.exports="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},{}],205:[function(t,e){e.exports=Array.isArray||function(t){return"[object Array]"==Object.prototype.toString.call(t)}},{}],206:[function(t,e){function n(){if(!s){s=!0;for(var t,e=o.length;e;){t=o,o=[];for(var n=-1;++n<e;)t[n]();e=o.length}s=!1}}function r(){}var i=e.exports={},o=[],s=!1;i.nextTick=function(t){o.push(t),s||setTimeout(n,0)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=r,i.addListener=r,i.once=r,i.off=r,i.removeListener=r,i.removeAllListeners=r,i.emit=r,i.binding=function(){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],207:[function(t,e){e.exports=t("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":208}],208:[function(t,e){(function(n){function r(t){return this instanceof r?(u.call(this,t),c.call(this,t),t&&t.readable===!1&&(this.readable=!1),t&&t.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,t&&t.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",i)):new r(t)}function i(){this.allowHalfOpen||this._writableState.ended||n.nextTick(this.end.bind(this))}function o(t,e){for(var n=0,r=t.length;r>n;n++)e(t[n],n)}e.exports=r;var s=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e},a=t("core-util-is");a.inherits=t("inherits");var u=t("./_stream_readable"),c=t("./_stream_writable");a.inherits(r,u),o(s(c.prototype),function(t){r.prototype[t]||(r.prototype[t]=c.prototype[t])})}).call(this,t("_process"))},{"./_stream_readable":210,"./_stream_writable":212,_process:206,"core-util-is":213,inherits:204}],209:[function(t,e){function n(t){return this instanceof n?void r.call(this,t):new n(t)}e.exports=n;var r=t("./_stream_transform"),i=t("core-util-is");i.inherits=t("inherits"),i.inherits(n,r),n.prototype._transform=function(t,e,n){n(null,t)}},{"./_stream_transform":211,"core-util-is":213,inherits:204}],210:[function(t,e){(function(n){function r(e,n){var r=t("./_stream_duplex");e=e||{};var i=e.highWaterMark,o=e.objectMode?16:16384;this.highWaterMark=i||0===i?i:o,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!e.objectMode,n instanceof r&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(A||(A=t("string_decoder/").StringDecoder),this.decoder=new A(e.encoding),this.encoding=e.encoding)}function i(e){t("./_stream_duplex");return this instanceof i?(this._readableState=new r(e,this),this.readable=!0,void P.call(this)):new i(e)}function o(t,e,n,r,i){var o=c(e,n);if(o)t.emit("error",o);else if(S.isNullOrUndefined(n))e.reading=!1,e.ended||l(t,e);else if(e.objectMode||n&&n.length>0)if(e.ended&&!i){var a=new Error("stream.push() after EOF");t.emit("error",a)}else if(e.endEmitted&&i){var a=new Error("stream.unshift() after end event");t.emit("error",a)}else!e.decoder||i||r||(n=e.decoder.write(n)),i||(e.reading=!1),e.flowing&&0===e.length&&!e.sync?(t.emit("data",n),t.read(0)):(e.length+=e.objectMode?1:n.length,i?e.buffer.unshift(n):e.buffer.push(n),e.needReadable&&h(t)),p(t,e);else i||(e.reading=!1);return s(e)}function s(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}function a(t){if(t>=O)t=O;else{t--;for(var e=1;32>e;e<<=1)t|=t>>e;t++}return t}function u(t,e){return 0===e.length&&e.ended?0:e.objectMode?0===t?0:1:isNaN(t)||S.isNull(t)?e.flowing&&e.buffer.length?e.buffer[0].length:e.length:0>=t?0:(t>e.highWaterMark&&(e.highWaterMark=a(t)),t>e.length?e.ended?e.length:(e.needReadable=!0,0):t)}function c(t,e){var n=null;return S.isBuffer(e)||S.isString(e)||S.isNullOrUndefined(e)||t.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}function l(t,e){if(e.decoder&&!e.ended){var n=e.decoder.end();n&&n.length&&(e.buffer.push(n),e.length+=e.objectMode?1:n.length)}e.ended=!0,h(t)}function h(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(T("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?n.nextTick(function(){f(t)}):f(t))}function f(t){T("emit readable"),t.emit("readable"),y(t)}function p(t,e){e.readingMore||(e.readingMore=!0,n.nextTick(function(){d(t,e)}))}function d(t,e){for(var n=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(T("maybeReadMore read 0"),t.read(0),n!==e.length);)n=e.length;e.readingMore=!1}function g(t){return function(){var e=t._readableState;T("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&j.listenerCount(t,"data")&&(e.flowing=!0,y(t))}}function v(t,e){e.resumeScheduled||(e.resumeScheduled=!0,n.nextTick(function(){m(t,e)}))}function m(t,e){e.resumeScheduled=!1,t.emit("resume"),y(t),e.flowing&&!e.reading&&t.read(0)}function y(t){var e=t._readableState;if(T("flow",e.flowing),e.flowing)do var n=t.read();while(null!==n&&e.flowing)}function b(t,e){var n,r=e.buffer,i=e.length,o=!!e.decoder,s=!!e.objectMode;if(0===r.length)return null;if(0===i)n=null;else if(s)n=r.shift();else if(!t||t>=i)n=o?r.join(""):k.concat(r,i),r.length=0;else if(t<r[0].length){var a=r[0];n=a.slice(0,t),r[0]=a.slice(t)}else if(t===r[0].length)n=r.shift();else{n=o?"":new k(t);for(var u=0,c=0,l=r.length;l>c&&t>u;c++){var a=r[0],h=Math.min(t-u,a.length);o?n+=a.slice(0,h):a.copy(n,u,0,h),h<a.length?r[0]=a.slice(h):r.shift(),u+=h}}return n}function _(t){var e=t._readableState;if(e.length>0)throw new Error("endReadable called on non-empty stream");e.endEmitted||(e.ended=!0,n.nextTick(function(){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}))}function w(t,e){for(var n=0,r=t.length;r>n;n++)e(t[n],n)}function x(t,e){for(var n=0,r=t.length;r>n;n++)if(t[n]===e)return n;return-1}e.exports=i;var E=t("isarray"),k=t("buffer").Buffer;i.ReadableState=r;var j=t("events").EventEmitter;j.listenerCount||(j.listenerCount=function(t,e){return t.listeners(e).length});var P=t("stream"),S=t("core-util-is");S.inherits=t("inherits");var A,T=t("util");T=T&&T.debuglog?T.debuglog("stream"):function(){},S.inherits(i,P),i.prototype.push=function(t,e){var n=this._readableState;return S.isString(t)&&!n.objectMode&&(e=e||n.defaultEncoding,e!==n.encoding&&(t=new k(t,e),e="")),o(this,n,t,e,!1)},i.prototype.unshift=function(t){var e=this._readableState;return o(this,e,t,"",!0)},i.prototype.setEncoding=function(e){return A||(A=t("string_decoder/").StringDecoder),this._readableState.decoder=new A(e),this._readableState.encoding=e,this};var O=8388608;i.prototype.read=function(t){T("read",t);var e=this._readableState,n=t;if((!S.isNumber(t)||t>0)&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return T("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?_(this):h(this),null;if(t=u(t,e),0===t&&e.ended)return 0===e.length&&_(this),null;var r=e.needReadable;T("need readable",r),(0===e.length||e.length-t<e.highWaterMark)&&(r=!0,T("length less than watermark",r)),(e.ended||e.reading)&&(r=!1,T("reading or ended",r)),r&&(T("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1),r&&!e.reading&&(t=u(n,e));var i;return i=t>0?b(t,e):null,S.isNull(i)&&(e.needReadable=!0,t=0),e.length-=t,0!==e.length||e.ended||(e.needReadable=!0),n!==t&&e.ended&&0===e.length&&_(this),S.isNull(i)||this.emit("data",i),i},i.prototype._read=function(){this.emit("error",new Error("not implemented"))},i.prototype.pipe=function(t,e){function r(t){T("onunpipe"),t===h&&o()}function i(){T("onend"),t.end()}function o(){T("cleanup"),t.removeListener("close",u),t.removeListener("finish",c),t.removeListener("drain",v),t.removeListener("error",a),t.removeListener("unpipe",r),h.removeListener("end",i),h.removeListener("end",o),h.removeListener("data",s),!f.awaitDrain||t._writableState&&!t._writableState.needDrain||v()}function s(e){T("ondata");var n=t.write(e);!1===n&&(T("false write response, pause",h._readableState.awaitDrain),h._readableState.awaitDrain++,h.pause())}function a(e){T("onerror",e),l(),t.removeListener("error",a),0===j.listenerCount(t,"error")&&t.emit("error",e)}function u(){t.removeListener("finish",c),l()}function c(){T("onfinish"),t.removeListener("close",u),l()}function l(){T("unpipe"),h.unpipe(t)}var h=this,f=this._readableState;switch(f.pipesCount){case 0:f.pipes=t;break;case 1:f.pipes=[f.pipes,t];break;default:f.pipes.push(t)}f.pipesCount+=1,T("pipe count=%d opts=%j",f.pipesCount,e);var p=(!e||e.end!==!1)&&t!==n.stdout&&t!==n.stderr,d=p?i:o;f.endEmitted?n.nextTick(d):h.once("end",d),t.on("unpipe",r);var v=g(h);return t.on("drain",v),h.on("data",s),t._events&&t._events.error?E(t._events.error)?t._events.error.unshift(a):t._events.error=[a,t._events.error]:t.on("error",a),t.once("close",u),t.once("finish",c),t.emit("pipe",h),f.flowing||(T("pipe resume"),h.resume()),t},i.prototype.unpipe=function(t){var e=this._readableState;if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this),this);if(!t){var n=e.pipes,r=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var i=0;r>i;i++)n[i].emit("unpipe",this);return this}var i=x(e.pipes,t);return-1===i?this:(e.pipes.splice(i,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this),this)},i.prototype.on=function(t,e){var r=P.prototype.on.call(this,t,e);if("data"===t&&!1!==this._readableState.flowing&&this.resume(),"readable"===t&&this.readable){var i=this._readableState;if(!i.readableListening)if(i.readableListening=!0,i.emittedReadable=!1,i.needReadable=!0,i.reading)i.length&&h(this,i);else{var o=this;n.nextTick(function(){T("readable nexttick read 0"),o.read(0)})}}return r},i.prototype.addListener=i.prototype.on,i.prototype.resume=function(){var t=this._readableState;return t.flowing||(T("resume"),t.flowing=!0,t.reading||(T("resume read 0"),this.read(0)),v(this,t)),this},i.prototype.pause=function(){return T("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(T("pause"),this._readableState.flowing=!1,this.emit("pause")),this},i.prototype.wrap=function(t){var e=this._readableState,n=!1,r=this;t.on("end",function(){if(T("wrapped end"),e.decoder&&!e.ended){var t=e.decoder.end();t&&t.length&&r.push(t)}r.push(null)}),t.on("data",function(i){if(T("wrapped data"),e.decoder&&(i=e.decoder.write(i)),i&&(e.objectMode||i.length)){var o=r.push(i);o||(n=!0,t.pause())}});for(var i in t)S.isFunction(t[i])&&S.isUndefined(this[i])&&(this[i]=function(e){return function(){return t[e].apply(t,arguments)}}(i));var o=["error","close","destroy","pause","resume"];return w(o,function(e){t.on(e,r.emit.bind(r,e))}),r._read=function(e){T("wrapped _read",e),n&&(n=!1,t.resume())},r},i._fromList=b}).call(this,t("_process"))},{"./_stream_duplex":208,_process:206,buffer:199,"core-util-is":213,events:203,inherits:204,isarray:205,stream:218,"string_decoder/":219,util:198}],211:[function(t,e){function n(t,e){this.afterTransform=function(t,n){return r(e,t,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function r(t,e,n){var r=t._transformState;r.transforming=!1;var i=r.writecb;if(!i)return t.emit("error",new Error("no writecb in Transform class"));r.writechunk=null,r.writecb=null,a.isNullOrUndefined(n)||t.push(n),i&&i(e);var o=t._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&t._read(o.highWaterMark)}function i(t){if(!(this instanceof i))return new i(t);s.call(this,t),this._transformState=new n(t,this);var e=this;this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("prefinish",function(){a.isFunction(this._flush)?this._flush(function(t){o(e,t)}):o(e)})}function o(t,e){if(e)return t.emit("error",e);var n=t._writableState,r=t._transformState;if(n.length)throw new Error("calling transform done when ws.length != 0");if(r.transforming)throw new Error("calling transform done when still transforming");return t.push(null)}e.exports=i;var s=t("./_stream_duplex"),a=t("core-util-is");a.inherits=t("inherits"),a.inherits(i,s),i.prototype.push=function(t,e){return this._transformState.needTransform=!1,s.prototype.push.call(this,t,e)},i.prototype._transform=function(){throw new Error("not implemented")},i.prototype._write=function(t,e,n){var r=this._transformState;if(r.writecb=n,r.writechunk=t,r.writeencoding=e,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},i.prototype._read=function(){var t=this._transformState;a.isNull(t.writechunk)||!t.writecb||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))}},{"./_stream_duplex":208,"core-util-is":213,inherits:204}],212:[function(t,e){(function(n){function r(t,e,n){this.chunk=t,this.encoding=e,this.callback=n}function i(e,n){var r=t("./_stream_duplex");e=e||{};var i=e.highWaterMark,o=e.objectMode?16:16384;this.highWaterMark=i||0===i?i:o,this.objectMode=!!e.objectMode,n instanceof r&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var s=e.decodeStrings===!1;this.decodeStrings=!s,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){p(n,t)},this.writecb=null,this.writelen=0,this.buffer=[],this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1}function o(e){var n=t("./_stream_duplex");return this instanceof o||this instanceof n?(this._writableState=new i(e,this),this.writable=!0,void E.call(this)):new o(e)}function s(t,e,r){var i=new Error("write after end");t.emit("error",i),n.nextTick(function(){r(i)})}function a(t,e,r,i){var o=!0;if(!(x.isBuffer(r)||x.isString(r)||x.isNullOrUndefined(r)||e.objectMode)){var s=new TypeError("Invalid non-string/buffer chunk");t.emit("error",s),n.nextTick(function(){i(s)}),o=!1}return o}function u(t,e,n){return!t.objectMode&&t.decodeStrings!==!1&&x.isString(e)&&(e=new w(e,n)),e}function c(t,e,n,i,o){n=u(e,n,i),x.isBuffer(n)&&(i="buffer");var s=e.objectMode?1:n.length;e.length+=s;var a=e.length<e.highWaterMark;return a||(e.needDrain=!0),e.writing||e.corked?e.buffer.push(new r(n,i,o)):l(t,e,!1,s,n,i,o),a}function l(t,e,n,r,i,o,s){e.writelen=r,e.writecb=s,e.writing=!0,e.sync=!0,n?t._writev(i,e.onwrite):t._write(i,o,e.onwrite),e.sync=!1}function h(t,e,r,i,o){r?n.nextTick(function(){e.pendingcb--,o(i)}):(e.pendingcb--,o(i)),t._writableState.errorEmitted=!0,t.emit("error",i)}function f(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function p(t,e){var r=t._writableState,i=r.sync,o=r.writecb;if(f(r),e)h(t,r,i,e,o);else{var s=m(t,r);s||r.corked||r.bufferProcessing||!r.buffer.length||v(t,r),i?n.nextTick(function(){d(t,r,s,o)}):d(t,r,s,o)}}function d(t,e,n,r){n||g(t,e),e.pendingcb--,r(),b(t,e)}function g(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function v(t,e){if(e.bufferProcessing=!0,t._writev&&e.buffer.length>1){for(var n=[],r=0;r<e.buffer.length;r++)n.push(e.buffer[r].callback);e.pendingcb++,l(t,e,!0,e.length,e.buffer,"",function(t){for(var r=0;r<n.length;r++)e.pendingcb--,n[r](t)}),e.buffer=[]}else{for(var r=0;r<e.buffer.length;r++){var i=e.buffer[r],o=i.chunk,s=i.encoding,a=i.callback,u=e.objectMode?1:o.length;if(l(t,e,!1,u,o,s,a),e.writing){r++;break}}r<e.buffer.length?e.buffer=e.buffer.slice(r):e.buffer.length=0}e.bufferProcessing=!1}function m(t,e){return e.ending&&0===e.length&&!e.finished&&!e.writing}function y(t,e){e.prefinished||(e.prefinished=!0,t.emit("prefinish"))}function b(t,e){var n=m(t,e);return n&&(0===e.pendingcb?(y(t,e),e.finished=!0,t.emit("finish")):y(t,e)),n}function _(t,e,r){e.ending=!0,b(t,e),r&&(e.finished?n.nextTick(r):t.once("finish",r)),e.ended=!0}e.exports=o;var w=t("buffer").Buffer;o.WritableState=i;var x=t("core-util-is");x.inherits=t("inherits");var E=t("stream");x.inherits(o,E),o.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},o.prototype.write=function(t,e,n){var r=this._writableState,i=!1;return x.isFunction(e)&&(n=e,e=null),x.isBuffer(t)?e="buffer":e||(e=r.defaultEncoding),x.isFunction(n)||(n=function(){}),r.ended?s(this,r,n):a(this,r,t,n)&&(r.pendingcb++,i=c(this,r,t,e,n)),i},o.prototype.cork=function(){var t=this._writableState;t.corked++},o.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.finished||t.bufferProcessing||!t.buffer.length||v(this,t))},o.prototype._write=function(t,e,n){n(new Error("not implemented"))},o.prototype._writev=null,o.prototype.end=function(t,e,n){var r=this._writableState;x.isFunction(t)?(n=t,t=null,e=null):x.isFunction(e)&&(n=e,e=null),x.isNullOrUndefined(t)||this.write(t,e),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||_(this,r,n)}}).call(this,t("_process"))},{"./_stream_duplex":208,_process:206,buffer:199,"core-util-is":213,inherits:204,stream:218}],213:[function(t,e,n){(function(t){function e(t){return Array.isArray(t)}function r(t){return"boolean"==typeof t}function i(t){return null===t}function o(t){return null==t}function s(t){return"number"==typeof t}function a(t){return"string"==typeof t}function u(t){return"symbol"==typeof t}function c(t){return void 0===t}function l(t){return h(t)&&"[object RegExp]"===m(t)}function h(t){return"object"==typeof t&&null!==t}function f(t){return h(t)&&"[object Date]"===m(t)}function p(t){return h(t)&&("[object Error]"===m(t)||t instanceof Error)}function d(t){return"function"==typeof t}function g(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function v(e){return t.isBuffer(e)}function m(t){return Object.prototype.toString.call(t)}n.isArray=e,n.isBoolean=r,n.isNull=i,n.isNullOrUndefined=o,n.isNumber=s,n.isString=a,n.isSymbol=u,n.isUndefined=c,n.isRegExp=l,n.isObject=h,n.isDate=f,n.isError=p,n.isFunction=d,n.isPrimitive=g,n.isBuffer=v}).call(this,t("buffer").Buffer)},{buffer:199}],214:[function(t,e){e.exports=t("./lib/_stream_passthrough.js")},{"./lib/_stream_passthrough.js":209}],215:[function(t,e,n){n=e.exports=t("./lib/_stream_readable.js"),n.Stream=t("stream"),n.Readable=n,n.Writable=t("./lib/_stream_writable.js"),n.Duplex=t("./lib/_stream_duplex.js"),n.Transform=t("./lib/_stream_transform.js"),n.PassThrough=t("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":208,"./lib/_stream_passthrough.js":209,"./lib/_stream_readable.js":210,"./lib/_stream_transform.js":211,"./lib/_stream_writable.js":212,stream:218}],216:[function(t,e){e.exports=t("./lib/_stream_transform.js")},{"./lib/_stream_transform.js":211}],217:[function(t,e){e.exports=t("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":212}],218:[function(t,e){function n(){r.call(this)}e.exports=n;var r=t("events").EventEmitter,i=t("inherits");i(n,r),n.Readable=t("readable-stream/readable.js"),n.Writable=t("readable-stream/writable.js"),n.Duplex=t("readable-stream/duplex.js"),n.Transform=t("readable-stream/transform.js"),n.PassThrough=t("readable-stream/passthrough.js"),n.Stream=n,n.prototype.pipe=function(t,e){function n(e){t.writable&&!1===t.write(e)&&c.pause&&c.pause()}function i(){c.readable&&c.resume&&c.resume()}function o(){l||(l=!0,t.end())}function s(){l||(l=!0,"function"==typeof t.destroy&&t.destroy())}function a(t){if(u(),0===r.listenerCount(this,"error"))throw t}function u(){c.removeListener("data",n),t.removeListener("drain",i),c.removeListener("end",o),c.removeListener("close",s),c.removeListener("error",a),t.removeListener("error",a),c.removeListener("end",u),c.removeListener("close",u),t.removeListener("close",u)}var c=this;c.on("data",n),t.on("drain",i),t._isStdio||e&&e.end===!1||(c.on("end",o),c.on("close",s));var l=!1;return c.on("error",a),t.on("error",a),c.on("end",u),c.on("close",u),t.on("close",u),t.emit("pipe",c),t}},{events:203,inherits:204,"readable-stream/duplex.js":207,"readable-stream/passthrough.js":214,"readable-stream/readable.js":215,"readable-stream/transform.js":216,"readable-stream/writable.js":217}],219:[function(t,e,n){function r(t){if(t&&!u(t))throw new Error("Unknown encoding: "+t)}function i(t){return t.toString(this.encoding)}function o(t){this.charReceived=t.length%2,this.charLength=this.charReceived?2:0}function s(t){this.charReceived=t.length%3,this.charLength=this.charReceived?3:0}var a=t("buffer").Buffer,u=a.isEncoding||function(t){switch(t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},c=n.StringDecoder=function(t){switch(this.encoding=(t||"utf8").toLowerCase().replace(/[-_]/,""),r(t),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=o;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=s;break;default:return void(this.write=i)}this.charBuffer=new a(6),this.charReceived=0,this.charLength=0};c.prototype.write=function(t){for(var e="";this.charLength;){var n=t.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:t.length;if(t.copy(this.charBuffer,this.charReceived,0,n),this.charReceived+=n,this.charReceived<this.charLength)return"";t=t.slice(n,t.length),e=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var r=e.charCodeAt(e.length-1);if(!(r>=55296&&56319>=r)){if(this.charReceived=this.charLength=0,0===t.length)return e;break}this.charLength+=this.surrogateSize,e=""}this.detectIncompleteChar(t);var i=t.length;this.charLength&&(t.copy(this.charBuffer,0,t.length-this.charReceived,i),i-=this.charReceived),e+=t.toString(this.encoding,0,i);var i=e.length-1,r=e.charCodeAt(i);if(r>=55296&&56319>=r){var o=this.surrogateSize;return this.charLength+=o,this.charReceived+=o,this.charBuffer.copy(this.charBuffer,o,0,o),t.copy(this.charBuffer,0,0,o),e.substring(0,i)}return e},c.prototype.detectIncompleteChar=function(t){for(var e=t.length>=3?3:t.length;e>0;e--){var n=t[t.length-e];if(1==e&&n>>5==6){this.charLength=2;break}if(2>=e&&n>>4==14){this.charLength=3;break}if(3>=e&&n>>3==30){this.charLength=4;break}}this.charReceived=e},c.prototype.end=function(t){var e="";if(t&&t.length&&(e=this.write(t)),this.charReceived){var n=this.charReceived,r=this.charBuffer,i=this.encoding;e+=r.slice(0,n).toString(i)}return e}},{buffer:199}],220:[function(t,e){e.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],221:[function(t,e,n){(function(e,r){function i(t,e){var r={seen:[],stylize:s};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),g(e)?r.showHidden=e:e&&n._extend(r,e),w(r.showHidden)&&(r.showHidden=!1),w(r.depth)&&(r.depth=2),w(r.colors)&&(r.colors=!1),w(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=o),u(r,t,r.depth)}function o(t,e){var n=i.styles[e];return n?"["+i.colors[n][0]+"m"+t+"["+i.colors[n][1]+"m":t}function s(t){return t}function a(t){var e={};return t.forEach(function(t){e[t]=!0}),e}function u(t,e,r){if(t.customInspect&&e&&P(e.inspect)&&e.inspect!==n.inspect&&(!e.constructor||e.constructor.prototype!==e)){var i=e.inspect(r,t);return b(i)||(i=u(t,i,r)),i}var o=c(t,e);if(o)return o;var s=Object.keys(e),g=a(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(e)),j(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return l(e);if(0===s.length){if(P(e)){var v=e.name?": "+e.name:"";return t.stylize("[Function"+v+"]","special")}if(x(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(k(e))return t.stylize(Date.prototype.toString.call(e),"date");if(j(e))return l(e)}var m="",y=!1,_=["{","}"];if(d(e)&&(y=!0,_=["[","]"]),P(e)){var w=e.name?": "+e.name:"";m=" [Function"+w+"]"}if(x(e)&&(m=" "+RegExp.prototype.toString.call(e)),k(e)&&(m=" "+Date.prototype.toUTCString.call(e)),j(e)&&(m=" "+l(e)),0===s.length&&(!y||0==e.length))return _[0]+m+_[1];if(0>r)return x(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var E;return E=y?h(t,e,r,g,s):s.map(function(n){return f(t,e,r,g,n,y)}),t.seen.pop(),p(E,m,_)}function c(t,e){if(w(e))return t.stylize("undefined","undefined");if(b(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return y(e)?t.stylize(""+e,"number"):g(e)?t.stylize(""+e,"boolean"):v(e)?t.stylize("null","null"):void 0}function l(t){return"["+Error.prototype.toString.call(t)+"]"}function h(t,e,n,r,i){for(var o=[],s=0,a=e.length;a>s;++s)o.push(I(e,String(s))?f(t,e,n,r,String(s),!0):"");return i.forEach(function(i){i.match(/^\d+$/)||o.push(f(t,e,n,r,i,!0))}),o}function f(t,e,n,r,i,o){var s,a,c;if(c=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]},c.get?a=c.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):c.set&&(a=t.stylize("[Setter]","special")),I(r,i)||(s="["+i+"]"),a||(t.seen.indexOf(c.value)<0?(a=v(n)?u(t,c.value,null):u(t,c.value,n-1),a.indexOf("\n")>-1&&(a=o?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n"))):a=t.stylize("[Circular]","special")),w(s)){if(o&&i.match(/^\d+$/))return a;s=JSON.stringify(""+i),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+a}function p(t,e,n){var r=0,i=t.reduce(function(t,e){return r++,e.indexOf("\n")>=0&&r++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}function d(t){return Array.isArray(t)}function g(t){return"boolean"==typeof t}function v(t){return null===t}function m(t){return null==t}function y(t){return"number"==typeof t}function b(t){return"string"==typeof t}function _(t){return"symbol"==typeof t}function w(t){return void 0===t}function x(t){return E(t)&&"[object RegExp]"===A(t)}function E(t){return"object"==typeof t&&null!==t}function k(t){return E(t)&&"[object Date]"===A(t)}function j(t){return E(t)&&("[object Error]"===A(t)||t instanceof Error)}function P(t){return"function"==typeof t}function S(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function A(t){return Object.prototype.toString.call(t)}function T(t){return 10>t?"0"+t.toString(10):t.toString(10)}function O(){var t=new Date,e=[T(t.getHours()),T(t.getMinutes()),T(t.getSeconds())].join(":");return[t.getDate(),B[t.getMonth()],e].join(" ")}function I(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var L=/%[sdj%]/g;n.format=function(t){if(!b(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(i(arguments[n]));return e.join(" ")}for(var n=1,r=arguments,o=r.length,s=String(t).replace(L,function(t){if("%%"===t)return"%";if(n>=o)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}}),a=r[n];o>n;a=r[++n])s+=v(a)||!E(a)?" "+a:" "+i(a);return s},n.deprecate=function(t,i){function o(){if(!s){if(e.throwDeprecation)throw new Error(i);e.traceDeprecation?console.trace(i):console.error(i),s=!0}return t.apply(this,arguments)}if(w(r.process))return function(){return n.deprecate(t,i).apply(this,arguments)};if(e.noDeprecation===!0)return t;var s=!1;return o};var R,M={};n.debuglog=function(t){if(w(R)&&(R=e.env.NODE_DEBUG||""),t=t.toUpperCase(),!M[t])if(new RegExp("\\b"+t+"\\b","i").test(R)){var r=e.pid;M[t]=function(){var e=n.format.apply(n,arguments);console.error("%s %d: %s",t,r,e)}}else M[t]=function(){};return M[t]},n.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=d,n.isBoolean=g,n.isNull=v,n.isNullOrUndefined=m,n.isNumber=y,n.isString=b,n.isSymbol=_,n.isUndefined=w,n.isRegExp=x,n.isObject=E,n.isDate=k,n.isError=j,n.isFunction=P,n.isPrimitive=S,n.isBuffer=t("./support/isBuffer");var B=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];n.log=function(){console.log("%s - %s",O(),n.format.apply(n,arguments))},n.inherits=t("inherits"),n._extend=function(t,e){if(!e||!E(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":220,_process:206,inherits:204}]},{},[1]);